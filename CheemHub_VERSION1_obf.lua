-- Obfuscated by ChatGPT
local b='Ci0tID09PT09PT09PT09PT09PT09IENIRUVNIEhVQiBTQUZFIE1PREUgPT09PT09PT09PT09PT09PT0KLS0gU0FGRSBNT0RFICsgRVJST1IgUEFORUwKLS0gKEF1dG8tZ2VuZXJhdGVkIHdyYXBwZXIsIGxvZ2ljIGluc2lkZSBpcyB1bmNoYW5nZWQpCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKLS0gPT09PT0gU0FGRSBSVU4gPT09PT0KICAgIGxvY2FsIGZ1bmN0aW9uIFNhZmVSdW4obmFtZSwgZm4pCiAgICBsb2NhbCBvaywgZXJyID0gcGNhbGwoZm4pCiAgICBpZiBub3Qgb2sgdGhlbgogICAgICAgIHdhcm4oIltTYWZlUnVuXSIsIG5hbWUsIGVycikKICAgIGVuZAogICAgcmV0dXJuIG9rCmVuZAoKU2FmZVJ1bigiTUFJTiIsIGZ1bmN0aW9uKCkKCgotLT09PT09PT09PT09PT09PT09PT09PT0gQ0hFRU0gSFVCIHwgQUxMIElOIE9ORSA9PT09PT09PT09PT09PT09PT09PT09LS0KLS0gTG9hZGVyICsgTWFwIERldGVjdCArIEh1YiArIFNhdmVDb25maWcgKyBBbnRpIEFGSwotLSBEZXYgZnJpZW5kbHkg4oCTIEtow7RuZyBjaOG6v3QgbWVudQoKaWYgZ2V0Z2VudigpLkNoZWVtSHViTG9hZGVkIHRoZW4gcmV0dXJuIGVuZApnZXRnZW52KCkuQ2hlZW1IdWJMb2FkZWQgPSB0cnVlCgpyZXBlYXQgdGFzay53YWl0KCkgdW50aWwgZ2FtZTpJc0xvYWRlZCgpCgotLT09PT09PT09PT09PT09PT09PT09PT0gU0VSVklDRVMgPT09PT09PT09PT09PT09PT09PT09PS0tCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQpsb2NhbCBWaXJ0dWFsVXNlciA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbFVzZXIiKQpsb2NhbCBUZWxlcG9ydFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlRlbGVwb3J0U2VydmljZSIpCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpCmxvY2FsIFN0YXJ0ZXJHdWkgPSBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKQpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKCmxvY2FsIFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKcmVwZWF0IHRhc2sud2FpdCgpIHVudGlsIFBsYXllcgpyZXBlYXQgdGFzay53YWl0KCkgdW50aWwgUGxheWVyLkNoYXJhY3RlcgoKbG9jYWwgVUlWaXNpYmxlID0gdHJ1ZQpsb2NhbCBHbG9iYWxVSSA9IG5pbAoKLS09PT09PT09PT09PT09PT09IE1JUkFHRSBTRVJWRVIgRklMVEVSID09PT09PT09PT09PT09PT09LS0KbG9jYWwgTGlnaHRpbmcgPSBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIikKbG9jYWwgU2VydmVyRW50ZXJUaWNrID0gdGljaygpCmxvY2FsIE1JUkFHRV9XQUlUX0xJTUlUID0gNDIwIC0tIDcgcGjDunQKbG9jYWwgUVVJQ0tfUkVKRUNUX1RJTUUgPSA1ICAgLS0gcmVqZWN0IOKJpCA1cwoKbG9jYWwgZnVuY3Rpb24gSXNOaWdodCgpCiAgICBsb2NhbCB0ID0gTGlnaHRpbmcuQ2xvY2tUaW1lCiAgICByZXR1cm4gKHQgPj0gMTggb3IgdCA8PSA1KQplbmQKCmxvY2FsIGZ1bmN0aW9uIEdldE1vb25QZXJjZW50KCkKICAgIC0tIFRyxINuZyBNaXJhZ2UgZOG7sWEgdsOgbyBNb29uUGhhc2UgKDAg4oaSIDEpCiAgICBpZiBMaWdodGluZzpGaW5kRmlyc3RDaGlsZCgiTW9vblBoYXNlIikgdGhlbgogICAgICAgIHJldHVybiBMaWdodGluZy5Nb29uUGhhc2UuVmFsdWUgKiAxMDAKICAgIGVuZAogICAgLS0gZmFsbGJhY2sgKMaw4bubYyBsxrDhu6NuZykKICAgIHJldHVybiAwCmVuZAoKbG9jYWwgZnVuY3Rpb24gSXNWYWxpZE1pcmFnZVNlcnZlcigpCiAgICBpZiBub3QgSXNOaWdodCgpIHRoZW4gcmV0dXJuIGZhbHNlLCAiREFZVElNRSIgZW5kCiAgICBpZiBHZXRNb29uUGVyY2VudCgpIDwgNzAgdGhlbiByZXR1cm4gZmFsc2UsICJMT1dfTU9PTiIgZW5kCiAgICByZXR1cm4gdHJ1ZSwgIk9LIgplbmQKCi0tPT09PT09PT09PT09PT09PSBKT0JJRCBCTEFDS0xJU1QgPT09PT09PT09PT09PT09PT0tLQpsb2NhbCBIdHRwU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKQpsb2NhbCBKb2JJZCA9IGdhbWUuSm9iSWQKCl9HLk1pcmFnZUJsYWNrTGlzdCA9IF9HLk1pcmFnZUJsYWNrTGlzdCBvciB7fQoKbG9jYWwgZnVuY3Rpb24gSXNKb2JCbGFja2xpc3RlZChpZCkKICAgIHJldHVybiBfRy5NaXJhZ2VCbGFja0xpc3RbaWRdID09IHRydWUKZW5kCgpsb2NhbCBmdW5jdGlvbiBBZGRKb2JCbGFja2xpc3QoaWQsIHJlYXNvbikKICAgIF9HLk1pcmFnZUJsYWNrTGlzdFtpZF0gPSB0cnVlCiAgICB3YXJuKCJbTUlSQUdFIEJMQUNLTElTVF0iLCBpZCwgcmVhc29uKQplbmQKCi0tID09PT09PT09PT09PT09PT09IFRIRU1FID09PT09PT09PT09PT09PT09CmxvY2FsIFRoZW1lID0gewogICAgRGFyayA9IHsKICAgICAgICBCYWNrZ3JvdW5kID0gQ29sb3IzLmZyb21SR0IoMjUsMjUsMjUpLAogICAgICAgIFNlY3Rpb24gICAgPSBDb2xvcjMuZnJvbVJHQig0MCw0MCw0MCksCiAgICAgICAgQWNjZW50ICAgICA9IENvbG9yMy5mcm9tUkdCKDI1NSwyMjEsMCksCiAgICAgICAgVGV4dCAgICAgICA9IENvbG9yMy5mcm9tUkdCKDI1NSwyNTUsMjU1KQogICAgfSwKICAgIExpZ2h0ID0gewogICAgICAgIEJhY2tncm91bmQgPSBDb2xvcjMuZnJvbVJHQigyMzUsMjM1LDIzNSksCiAgICAgICAgU2VjdGlvbiAgICA9IENvbG9yMy5mcm9tUkdCKDIxMCwyMTAsMjEwKSwKICAgICAgICBBY2NlbnQgICAgID0gQ29sb3IzLmZyb21SR0IoNjAsMTgwLDc1KSwKICAgICAgICBUZXh0ICAgICAgID0gQ29sb3IzLmZyb21SR0IoMzAsMzAsMzApCiAgICB9Cn0KCmxvY2FsIEN1cnJlbnRUaGVtZSA9ICJEYXJrIgoKbG9jYWwgZnVuY3Rpb24gQXBwbHlUaGVtZSh0aGVtZU5hbWUpCiAgICBsb2NhbCB0ID0gVGhlbWVbdGhlbWVOYW1lXQogICAgaWYgbm90IHQgdGhlbiByZXR1cm4gZW5kCgogICAgZm9yIF8sdiBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJDb3JlR3VpIik6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICBpZiB2OklzQSgiRnJhbWUiKSB0aGVuCiAgICAgICAgICAgIHYuQmFja2dyb3VuZENvbG9yMyA9IHQuQmFja2dyb3VuZAogICAgICAgIGVsc2VpZiB2OklzQSgiVGV4dEJ1dHRvbiIpIHRoZW4KICAgICAgICAgICAgdi5CYWNrZ3JvdW5kQ29sb3IzID0gdC5TZWN0aW9uCiAgICAgICAgICAgIHYuVGV4dENvbG9yMyA9IHQuVGV4dAogICAgICAgIGVsc2VpZiB2OklzQSgiVGV4dExhYmVsIikgdGhlbgogICAgICAgICAgICB2LlRleHRDb2xvcjMgPSB0LlRleHQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tPT09PT0gS0VZIFNZU1RFTSAoU0FWRSBLRVkpID09PT09LS0KCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBIdHRwU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKQpsb2NhbCBQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgpsb2NhbCBLZXlGaWxlID0gIkNoZWVtSHViX0tleS5qc29uIgoKbG9jYWwgZnVuY3Rpb24gUmVzZXRLZXkoKQogICAgaWYgaXNmaWxlKEtleUZpbGUpIHRoZW4KICAgICAgICBkZWxmaWxlKEtleUZpbGUpCiAgICBlbmQKZW5kCgpsb2NhbCBWQUxJRF9LRVlTID0gewogICAgIjhTU0ExOEM3Mjg1MkFLWFQxQVMwMEdSIiwKICAgICI1RFNBSDgyNzM2MjY2QUhGTzY1NUFTRCIsCiAgICAiMkhGU0Q3NUFGNzRGU0VHTzc1NUhER0giLAogICAgIjFTR0RGNDRER0NGNjRGQ1NTSEc3NURGIiwgCiAgICAiOFg5RlFLN0EyTVpQNExKNkRSRVdIVE5WQyIsIAogICAgIjNBN005UUtETFgyRjhQWko1SEVOUlZDVyIsIAogICAgIjZQWlE4TTJSN0Y5QTRYS0xESEVOSlZDIiwgCiAgICAiMVI3WFE5TVpQOEYySzRBRExKSEVOVkMiLCAKICAgICI5S1o4UDdGMlhRNE1SQUhFTkxESlZDIiwgCiAgICAiNFgyRjlROE1aN1JQS0FETEpIRU5WQyIsIAogICAgIjdROVhLOFAyRlpNNFJEQUhFTkxKVkMiLCAKICAgICIyTTlRS1o3UDhGNFhSQURIRU5MSlZDIiwgCiAgICAiNUY4UTlYN1AyS1pNNFJEQUhFTkxKVkMiLCAKICAgICIwWDlRN0s4RjJQWk00UkRBSEVOTEpWQyIsIAp9CgotLSA9PT09PSBDaGVjayBrZXkgPT09PT0KbG9jYWwgZnVuY3Rpb24gSXNWYWxpZEtleShrZXkpCiAgICBmb3IgXywgdiBpbiBpcGFpcnMoVkFMSURfS0VZUykgZG8KICAgICAgICBpZiBrZXkgPT0gdiB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKCi0tID09PT09IExvYWQgc2F2ZWQga2V5ID09PT09CmxvY2FsIGZ1bmN0aW9uIExvYWRTYXZlZEtleSgpCiAgICBpZiBpc2ZpbGUoS2V5RmlsZSkgdGhlbgogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGRhdGEgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIHJldHVybiBIdHRwU2VydmljZTpKU09ORGVjb2RlKHJlYWRmaWxlKEtleUZpbGUpKQogICAgICAgIGVuZCkKCiAgICAgICAgaWYgc3VjY2VzcyBhbmQgZGF0YSBhbmQgZGF0YS5rZXkgdGhlbgogICAgICAgICAgICByZXR1cm4gZGF0YS5rZXkKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIG5pbAplbmQKCi0tID09PT09IFNhdmUga2V5ID09PT09CmxvY2FsIGZ1bmN0aW9uIFNhdmVLZXkoa2V5KQogICAgd3JpdGVmaWxlKEtleUZpbGUsIEh0dHBTZXJ2aWNlOkpTT05FbmNvZGUoewogICAgICAgIGtleSA9IGtleSwKICAgICAgICB0aW1lID0gb3MudGltZSgpCiAgICB9KSkKZW5kCgotLSA9PT09PT09PT09PT09PT09PSBBVVRPIExPR0lOID09PT09PT09PT09PT09PT09CmxvY2FsIHNhdmVkS2V5ID0gTG9hZFNhdmVkS2V5KCkKbG9jYWwgS2V5UGFzc2VkID0gZmFsc2UKCmlmIHNhdmVkS2V5IGFuZCBJc1ZhbGlkS2V5KHNhdmVkS2V5KSB0aGVuCiAgICBwcmludCgiQ2hlZW1IdWI6IEF1dG8gbG9naW4gc3VjY2VzcyIpCiAgICBLZXlQYXNzZWQgPSB0cnVlCmVuZAoKaWYgbm90IEtleVBhc3NlZCB0aGVuCgotLSA9PT09PT09PT09PT09PT09PSBLRVkgVUkgPT09PT09PT09PT09PT09PT0KbG9jYWwgU2NyZWVuR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQpTY3JlZW5HdWkuTmFtZSA9ICJDaGVlbUh1Yl9LZXlVSSIKU2NyZWVuR3VpLlBhcmVudCA9IFBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpCgpsb2NhbCBGcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBTY3JlZW5HdWkpCkZyYW1lLlNpemUgPSBVRGltMi5mcm9tU2NhbGUoMC4zNSwgMC4yNSkKRnJhbWUuUG9zaXRpb24gPSBVRGltMi5mcm9tU2NhbGUoMC4zMjUsIDAuMzUpCkZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNSwyNSwyNSkKRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMApGcmFtZS5BY3RpdmUgPSB0cnVlCkZyYW1lLkRyYWdnYWJsZSA9IHRydWUKCmxvY2FsIFVJQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIEZyYW1lKQpVSUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLDEwKQoKbG9jYWwgVGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIsIEZyYW1lKQpUaXRsZS5TaXplID0gVURpbTIuZnJvbVNjYWxlKDEsMC4yNSkKVGl0bGUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKVGl0bGUuVGV4dCA9ICJDaGVlbSBIdWIgfCBLZXkgU3lzdGVtIgpUaXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDIwMCwwKQpUaXRsZS5UZXh0U2NhbGVkID0gdHJ1ZQpUaXRsZS5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKCmxvY2FsIEJveCA9IEluc3RhbmNlLm5ldygiVGV4dEJveCIsIEZyYW1lKQpCb3guU2l6ZSA9IFVEaW0yLmZyb21TY2FsZSgwLjksMC4yNSkKQm94LlBvc2l0aW9uID0gVURpbTIuZnJvbVNjYWxlKDAuMDUsMC4zNSkKQm94LlBsYWNlaG9sZGVyVGV4dCA9ICJLZXkgSGVyZSIKQm94LlRleHQgPSAiIgpCb3guVGV4dFNjYWxlZCA9IHRydWUKQm94LkNsZWFyVGV4dE9uRm9jdXMgPSBmYWxzZQpCb3guQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDM1LDM1LDM1KQpCb3guVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMSwxLDEpCgpJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgQm94KS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLDYpCgpsb2NhbCBCdG4gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iLCBGcmFtZSkKQnRuLlNpemUgPSBVRGltMi5mcm9tU2NhbGUoMC41LDAuMjIpCkJ0bi5Qb3NpdGlvbiA9IFVEaW0yLmZyb21TY2FsZSgwLjI1LDAuNjgpCkJ0bi5UZXh0ID0gIkNoZWNrIEtleSIKQnRuLlRleHRTY2FsZWQgPSB0cnVlCkJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDIwMCwwKQpCdG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsMCwwKQoKSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIEJ0bikuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCw2KQoKLS0gPT09PT0gQnV0dG9uIGxvZ2ljID09PT09CkJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGxvY2FsIGtleSA9IEJveC5UZXh0CgogICAgaWYgSXNWYWxpZEtleShrZXkpIHRoZW4KICAgICAgICBTYXZlS2V5KGtleSkKICAgICAgICBTY3JlZW5HdWk6RGVzdHJveSgpCiAgICAgICAgcHJpbnQoIkNoZWVtSHViOiBLZXkgdmVyaWZpZWQiKQogICAgZWxzZQogICAgICAgIEJveC5UZXh0ID0gIiIKICAgICAgICBCdG4uVGV4dCA9ICJXcm9uZyBLZXkiCiAgICAgICAgQnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsODAsODApCiAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgQnRuLlRleHQgPSAiQ2hlY2sgS2V5IgogICAgICAgIEJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDIwMCwwKQogICAgZW5kCgpyZXBlYXQgdGFzay53YWl0KCkgdW50aWwgbm90IFNjcmVlbkd1aS5QYXJlbnQKCmVuZAoKLS09PT09PT09PT09PT09PT09PT09PT09IE5PVElGWSA9PT09PT09PT09PT09PT09PT09PT09LS0KbG9jYWwgZnVuY3Rpb24gTm90aWZ5KHR4dCwgdCkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBTdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLHsKICAgICAgICAgICAgVGl0bGUgPSAiQ2hlZW0gSHViIiwKICAgICAgICAgICAgVGV4dCA9IHR4dCwKICAgICAgICAgICAgRHVyYXRpb24gPSB0IG9yIDQKICAgICAgICB9KSAKICAgZW5kKSAKZW5kCgpOb3RpZnkoIkxvYWRpbmcgQ2hlZW0gSHViLi4uIikKCi0tPT09PT09PT09PT09PT09PT09PT09PSBDT05GSUcgPT09PT09PT09PT09PT09PT09PT09PS0tCmxvY2FsIENvbmZpZ0ZpbGUgPSAiQ2hlZW1IdWJfQ29uZmlnLmpzb24iCgpsb2NhbCBDaGVlbSA9IHt9Cgpsb2NhbCBhdHRhY2tpbmcgPSBmYWxzZQpsb2NhbCBsYXN0UXVlc3QgPSAiIgoKQ2hlZW0uQXV0b0NsaWNrID0gZmFsc2UKQ2hlZW0uRmFzdEF0dGFjayA9IGZhbHNlCkNoZWVtLkF1dG9UcmlhbCA9IGZhbHNlCkNoZWVtLkF1dG9GYXJtQm9uZXMgPSBmYWxzZQpDaGVlbS5BdXRvVjMgPSBmYWxzZQpDaGVlbS5BdXRvVjQgPSBmYWxzZQoKQ2hlZW0uRmFybU1vZGUgPSAiTGV2ZWwiIC0tIExldmVsIHwgQm9uZXMKQ2hlZW0uV2VhcG9uID0gIk1lbGVlIiAgICAgIC0tIHbFqSBraMOtIGTDuW5nIGtoaSBBdXRvIEZhcm0KQ2hlZW0uVHJpYWxXZWFwb24gPSAiTWVsZWUiIC0tIHbFqSBraMOtIGTDuW5nIGtoaSDEkcOhbmggVHJpYWwKCi0tID09PT09PT09PT09PT09PT09IEZVTkNUSU9OIENIVU5HID09PT09PT09PT09PT09PT09Cgpsb2NhbCBmdW5jdGlvbiBJc0Zhcm1pbmcoKQogICAgaWYgQ2hlZW0uRmFybU1vZGUgPT0gIkxldmVsIiBhbmQgQ2hlZW0uQXV0b0Zhcm0gdGhlbgogICAgICAgIHJldHVybiB0cnVlCiAgICBlbmQKICAgIGlmIENoZWVtLkZhcm1Nb2RlID09ICJCb25lcyIgYW5kIENoZWVtLkF1dG9GYXJtQm9uZXMgdGhlbgogICAgICAgIHJldHVybiB0cnVlCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKLS0gPT09PT0gQVVUTyBWMyAvIFY0IChEw4FOIOG7niDEkMOCWSkgPT09PT0KbG9jYWwgZnVuY3Rpb24gVHJ5RW5hYmxlVjMoKQogICAgaWYgbm90IENoZWVtLkF1dG9WMyB0aGVuIHJldHVybiBlbmQKICAgIGlmIG5vdCBJc0Zhcm1pbmcoKSB0aGVuIHJldHVybiBlbmQKCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgY2hhciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgLS0gxJFhIHPhu5EgVjMgY8OzIG1hcmtlciBBdXJhIC8gQWJpbGl0eQogICAgICAgIGlmIG5vdCBjaGFyOkZpbmRGaXJzdENoaWxkKCJSYWNlVjMiKSB0aGVuCiAgICAgICAgICAgIC0tIGdp4bqjIGNsaWNrIHNraWxsIChhbiB0b8OgbiBoxqFuIGZpcmUgcmVtb3RlKQogICAgICAgICAgICBWaXJ0dWFsVXNlcjpCdXR0b24xRG93bihWZWN0b3IyLm5ldygwLDApKQogICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgVmlydHVhbFVzZXI6QnV0dG9uMVVwKFZlY3RvcjIubmV3KDAsMCkpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gVHJ5RW5hYmxlVjQoKQogICAgaWYgbm90IENoZWVtLkF1dG9WNCB0aGVuIHJldHVybiBlbmQKICAgIGlmIG5vdCBJc0Zhcm1pbmcoKSB0aGVuIHJldHVybiBlbmQKCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgY2hhciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgLS0gxJFhIHPhu5EgVjQgY8OzIFRyYW5zZm9ybWF0aW9uIC8gQXdha2VuaW5nCiAgICAgICAgaWYgY2hhcjpGaW5kRmlyc3RDaGlsZCgiUmFjZUVuZXJneSIpIHRoZW4KICAgICAgICAgICAgVmlydHVhbFVzZXI6QnV0dG9uMURvd24oVmVjdG9yMi5uZXcoMCwwKSkKICAgICAgICAgICAgdGFzay53YWl0KDAuMDUpCiAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFVcChWZWN0b3IyLm5ldygwLDApKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tLy8gPT09PT09PT09PT09PT09PT0gU0VBIERFVEVDVCA9PT09PT09PT09PT09PT09PQpsb2NhbCBmdW5jdGlvbiBHZXRTZWEoKQogICAgaWYgZ2FtZS5QbGFjZUlkID09IDI3NTM5MTU1NDkgdGhlbgogICAgICAgIHJldHVybiAxCiAgICBlbHNlaWYgZ2FtZS5QbGFjZUlkID09IDQ0NDIyNzIxODMgdGhlbgogICAgICAgIHJldHVybiAyCiAgICBlbHNlaWYgZ2FtZS5QbGFjZUlkID09IDc0NDk0MjM2MzUgdGhlbgogICAgICAgIHJldHVybiAzCiAgICBlbmQKZW5kCgpsb2NhbCBDdXJyZW50U2VhID0gR2V0U2VhKCkKCmxvY2FsIGZ1bmN0aW9uIFVwZGF0ZVNlYSgpCiAgICBDdXJyZW50U2VhID0gR2V0U2VhKCkKZW5kCgotLT09PT09PT09PSBMT09QIFVQREFURSBTRUEgPT09PT09LS0KdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoMikgZG8KICAgICAgICBVcGRhdGVTZWEoKQogICAgZW5kCmVuZCkKCi0tID09PT09IExPT1AgQ0hFQ0sgTUFQIFRSSUFMID09PT09PT09PT09PT09LS0KbG9jYWwgZnVuY3Rpb24gSXNJblRyaWFsKCkKICAgIGxvY2FsIHBsYWNlID0gZ2FtZS5QbGFjZUlkCiAgICAtLSBUcmlhbCBWNCBtYXAKICAgIHJldHVybiBwbGFjZSA9PSA3NDQ5NDIzNjM1IG9yIHBsYWNlID09IDQ0NDIyNzIxODMKZW5kCgp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRhc2sud2FpdCgxKSBkbwogICAgICAgIENoZWVtLkluVHJpYWwgPSBJc0luVHJpYWwoKQogICAgZW5kCmVuZCkgCgotLT09PT09PT09PT09PT09PT0gTUlTU0lORyBGVU5DVElPTlMgRklYID09PT09PT09PT09PT09PT09LS0KCmZ1bmN0aW9uIEVxdWlwRmFybVdlYXBvbigpCiAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgd2VhcG9uID0gQ2hlZW0uSW5UcmlhbCBhbmQgQ2hlZW0uVHJpYWxXZWFwb24gb3IgQ2hlZW0uV2VhcG9uCiAgICBpZiBub3Qgd2VhcG9uIHRoZW4gcmV0dXJuIGVuZAoKICAgIGZvciBfLHRvb2wgaW4gcGFpcnMoUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgIGlmIHdlYXBvbiA9PSAiTWVsZWUiIHRoZW4KICAgICAgICAgICAgICAgIGNoYXIuSHVtYW5vaWQ6RXF1aXBUb29sKHRvb2wpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIHdlYXBvbiA9PSAiU3dvcmQiIGFuZCB0b29sLlRvb2xUaXA6bG93ZXIoKTpmaW5kKCJzd29yZCIpIHRoZW4KICAgICAgICAgICAgICAgIGNoYXIuSHVtYW5vaWQ6RXF1aXBUb29sKHRvb2wpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIHdlYXBvbiA9PSAiR3VuIiBhbmQgdG9vbC5Ub29sVGlwOmxvd2VyKCk6ZmluZCgiZ3VuIikgdGhlbgogICAgICAgICAgICAgICAgY2hhci5IdW1hbm9pZDpFcXVpcFRvb2wodG9vbCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmZ1bmN0aW9uIEJ1eVN0eWxlKHN0eWxlKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJlbW90ZXMuQ29tbUZfOkludm9rZVNlcnZlcigiQnV5IiAuLiBzdHlsZSkKICAgIGVuZCkKZW5kCgpmdW5jdGlvbiBIb3BTZXJ2ZXIoKQogICAgbG9jYWwgc2VydmVycyA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORGVjb2RlKAogICAgICAgIGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9nYW1lcy5yb2Jsb3guY29tL3YxL2dhbWVzLyIuLmdhbWUuUGxhY2VJZC4uIi9zZXJ2ZXJzL1B1YmxpYz9zb3J0T3JkZXI9QXNjJmxpbWl0PTEwMCIpCiAgICApCgogICAgZm9yIF8scyBpbiBwYWlycyhzZXJ2ZXJzLmRhdGEpIGRvCiAgICAgICAgaWYgcy5wbGF5aW5nIDwgcy5tYXhQbGF5ZXJzIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRTZXJ2aWNlOlRlbGVwb3J0VG9QbGFjZUluc3RhbmNlKGdhbWUuUGxhY2VJZCwgcy5pZCwgUGxheWVyKQogICAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgZW5kCmVuZAoKZnVuY3Rpb24gU2F2ZUNvbmZpZygpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgd3JpdGVmaWxlKCJDaGVlbUh1Yl9Db25maWcuanNvbiIsIEh0dHBTZXJ2aWNlOkpTT05FbmNvZGUoQ2hlZW0pKQogICAgZW5kKSAKZW5kCgotLT09PT09PT09PT09PT09PT0gRU5EIEZJWCA9PT09PT09PT09PT09PT09PS0tCgotLSA9PT09PT09PT09PT09PT09PSBOT0NMSVAgPT09PT09PT09PT09PT09PT0KZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGlmIENoZWVtLk5vY2xpcCB0aGVuCiAgICAgICAgbG9jYWwgY2hhciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyIHRoZW4KICAgICAgICAgICAgZm9yIF8sdiBpbiBwYWlycyhjaGFyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiB2OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdi5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKLS0gPT09PT09PT09PT09PT09PT0gRkxZID09PT09PT09PT09PT09PT09CmxvY2FsIEZseUJWLCBGbHlCRwoKZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGlmIG5vdCBDaGVlbS5GbHkgdGhlbgogICAgICAgIGlmIEZseUJWIHRoZW4gRmx5QlY6RGVzdHJveSgpIEZseUJWPW5pbCBlbmQKICAgICAgICBpZiBGbHlCRyB0aGVuIEZseUJHOkRlc3Ryb3koKSBGbHlCRz1uaWwgZW5kCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgbG9jYWwgaHJwID0gY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBub3QgaHJwIHRoZW4gcmV0dXJuIGVuZAoKICAgIGlmIG5vdCBGbHlCViB0aGVuCiAgICAgICAgRmx5QlYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIpCiAgICAgICAgRmx5QlYuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyg5ZTksOWU5LDllOSkKICAgICAgICBGbHlCVi5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgIEZseUJWLlBhcmVudCA9IGhycAoKICAgICAgICBGbHlCRyA9IEluc3RhbmNlLm5ldygiQm9keUd5cm8iKQogICAgICAgIEZseUJHLk1heFRvcnF1ZSA9IFZlY3RvcjMubmV3KDllOSw5ZTksOWU5KQogICAgICAgIEZseUJHLkNGcmFtZSA9IGhycC5DRnJhbWUKICAgICAgICBGbHlCRy5QYXJlbnQgPSBocnAKICAgIGVuZAoKICAgIGxvY2FsIGNhbSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCiAgICBGbHlCRy5DRnJhbWUgPSBjYW0uQ0ZyYW1lCiAgICBGbHlCVi5WZWxvY2l0eSA9IGNhbS5DRnJhbWUuTG9va1ZlY3RvciAqIDgwCgotLT09PT09IExPT1AgPT09PT09PS0tClVzZXJJbnB1dFNlcnZpY2UuSnVtcFJlcXVlc3Q6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBDaGVlbS5JbmZKdW1wIHRoZW4KICAgICAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgaWYgaHVtIHRoZW4KICAgICAgICAgICAgaHVtOkNoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuSnVtcGluZykKICAgICAgICBlbmQKICAgIGVuZAoKQ2hlZW0uSW5UcmlhbCA9IGZhbHNlCgpDaGVlbS5XYWxrU3BlZWQgPSAxNgpDaGVlbS5KdW1wUG93ZXIgPSA1MApDaGVlbS5JbmZKdW1wID0gZmFsc2UKCkNoZWVtLkJ1eUNoaXAgPSBmYWxzZQpDaGVlbS5DaGlwRnJ1aXQgPSAiRmxhbWUiCgotLSA9PT09PSBBV0FLRU4gUkFJRCA9PT09PQpDaGVlbS5BdXRvQXdha2VuID0gZmFsc2UKQ2hlZW0uQXdha2VuU2tpbGwgPSAiWiIKQ2hlZW0uQXV0b1JhaWQgPSBmYWxzZQpDaGVlbS5SYWlkVGVsZXBvcnQgPSB0cnVlCgotLT09PT09PT09PT09PT09PT09IFJBSUQgVEVMRVBPUlQgPT09PT09PT09PT09PT09PT0KbG9jYWwgZnVuY3Rpb24gVGVsZXBvcnRUb1JhaWQoKQogICAgaWYgbm90IENoZWVtLlJhaWRUZWxlcG9ydCB0aGVuIHJldHVybiBlbmQKCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUmVtb3Rlcy5Db21tRl86SW52b2tlU2VydmVyKAogICAgICAgICAgICAiUmFpZHNOcGMiLCJTZWxlY3QiLCJGbGFtZSIKICAgICAgICApCiAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUmVtb3Rlcy5Db21tRl86SW52b2tlU2VydmVyKAogICAgICAgICAgICAiUmFpZHNOcGMiLCJTdGFydCIKICAgICAgICApCiAgICBlbmQpCmVuZAoKLS09PT09PT09PT09PT09PT09PT09PSBCVVkgQ0hJUCA9PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBmdW5jdGlvbiBCdXlDaGlwKCkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SZW1vdGVzLkNvbW1GXzpJbnZva2VTZXJ2ZXIoCiAgICAgICAgICAgICJSYWlkc05wYyIsCiAgICAgICAgICAgICJTZWxlY3QiLAogICAgICAgICAgICBDaGVlbS5DaGlwRnJ1aXQKICAgICAgICApCiAgICBlbmQpCmVuZAoKLS09PT09PT09PT09PT09PT09PSBBVVRPIEFXQUtFTiBMT09QID09PT09PT09PT09PT09PT09CnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdGFzay53YWl0KDAuMykgZG8KICAgICAgICBpZiBub3QgQ2hlZW0uQXV0b0F3YWtlbiB0aGVuIGNvbnRpbnVlIGVuZAoKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIFRlbGVwb3J0VG9SYWlkKCkKICAgICAgICAgICAgQXR0YWNrUmFpZE1vYigpCiAgICAgICAgZW5kKQogICAgZW5kCmVuZCkKCi0tPT09PT09PT09PT09PT09PSBMT09QIEJVWSBDSElQID09PT09PT09PT09PT09PT0KdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoNSkgZG8KICAgICAgICBpZiBDaGVlbS5CdXlDaGlwIHRoZW4KICAgICAgICAgICAgQnV5Q2hpcCgpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0tPT09PT09PT09PT09PT09PSBBVFRBQ0sgUkFJRCBNT0IgKEZJWEVEKSA9PT09PT09PT09PT09PT09PS0tCmxvY2FsIGF0dGFja2luZ1JhaWQgPSBmYWxzZQoKZnVuY3Rpb24gQXR0YWNrUmFpZE1vYigpCiAgICBpZiBhdHRhY2tpbmdSYWlkIHRoZW4gcmV0dXJuIGVuZAogICAgYXR0YWNraW5nUmFpZCA9IHRydWUKCiAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbiBhdHRhY2tpbmdSYWlkID0gZmFsc2UgcmV0dXJuIGVuZAoKICAgIGxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgbG9jYWwgaHVtID0gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgIGlmIG5vdCBocnAgb3Igbm90IGh1bSBvciBodW0uSGVhbHRoIDw9IDAgdGhlbgogICAgICAgIGF0dGFja2luZ1JhaWQgPSBmYWxzZQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgZW5lbWllcyA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiRW5lbWllcyIpCiAgICBpZiBub3QgZW5lbWllcyB0aGVuCiAgICAgICAgYXR0YWNraW5nUmFpZCA9IGZhbHNlCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBmb3IgXywgbW9iIGluIHBhaXJzKGVuZW1pZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBub3QgQ2hlZW0uQXV0b1RyaWFsIHRoZW4gYnJlYWsgZW5kCgogICAgICAgIGlmIG1vYjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgIGFuZCBtb2I6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGFuZCBtb2IuSHVtYW5vaWQuSGVhbHRoID4gMCB0aGVuCgogICAgICAgICAgICBsb2NhbCBtaHVtID0gbW9iLkh1bWFub2lkCiAgICAgICAgICAgIGxvY2FsIG1ocnAgPSBtb2IuSHVtYW5vaWRSb290UGFydAoKICAgICAgICAgICAgLS0g8J+UkiBHaeG7ryBt4bulYyB0acOqdSBjaG8gxJHhur9uIGtoaSBjaOG6v3QKICAgICAgICAgICAgd2hpbGUgbWh1bS5IZWFsdGggPiAwIGFuZCBDaGVlbS5BdXRvVHJpYWwgZG8KICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBocnAuQ0ZyYW1lID0gbWhycC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIDEwLCAwKQoKICAgICAgICAgICAgICAgIC0tIEVxdWlwIMSRw7puZyB2xakga2jDrSBUcmlhbAogICAgICAgICAgICAgICAgRXF1aXBGYXJtV2VhcG9uKCkKCiAgICAgICAgICAgICAgICAtLSBDbGljayDEkcOhbmgKICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFEb3duKFZlY3RvcjIubmV3KDAsMCkpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFVcChWZWN0b3IyLm5ldygwLDApKQoKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgYXR0YWNraW5nUmFpZCA9IGZhbHNlCmVuZAoKLS09PT09PT09PT09PT09PT09IEFVVE8gRklHSFQgVFJJQUwgTE9PUCA9PT09PT09PT09PT09PT09PS0tCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdGFzay53YWl0KDAuMykgZG8KICAgICAgICBpZiBDaGVlbS5BdXRvVHJpYWwgYW5kIENoZWVtLkluVHJpYWwgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBBdHRhY2tSYWlkTW9iKCkKICAgICAgICBlbmQKICAgIGVuZAoKbG9jYWwgR2FtZUNvZGVzID0gewogICAgIlNFQ1JFVF9BRE1JTiIsCiAgICAiU1VCMkdBTUVSUk9CT1RfRVhQMSIsCiAgICAiU1VCMk5PT0JNQVNURVIxMjMiLAogICAgIlNVQjJVTkNMRUtJWkFSVSIsCiAgICAiU1VCMkRBSUdST0NLIiwKICAgICJBWElPUkUiLAogICAgIkJJR05FV1MiLAogICAgIlNUUkFXSEFUTUFJTkUiLAogICAgIlRBTlRBSV9HQU1JTkciLAogICAgIlNVQjJGRVI5OTkiLAogICAgIlRIRUdSRUFUQUNFIiwKICAgICJLSVRUX1JFU0VUIiwKICAgICJTVUIyR0FNRVJST0JPVF9SRVNFVDEiLAogICAgIkZVREQxMCIsCiAgICAiRlVERDEwX1YyIiwKICAgICJDSEFORExFUiIsCiAgICAiRU5ZVV9JU19QUk8iLAogICAgIlNUQVJDT0RFSEVPIiwKICAgICJCTFVYWFkiLAogICAgIkpDV0siLAogICAgIk1BR0lDQlVTIiwKfQoKbG9jYWwgUmVkZWVtZWRDb2RlcyA9IHt9Cgpsb2NhbCBmdW5jdGlvbiBSZWRlZW1Db2RlKGNvZGUpCiAgICBpZiBSZWRlZW1lZENvZGVzW2NvZGVdIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHN1Y2Nlc3MgPSBwY2FsbChmdW5jdGlvbigpCiAgICBSZXBsaWNhdGVkU3RvcmFnZS5SZW1vdGVzLlJlZGVlbTpJbnZva2VTZXJ2ZXIoY29kZSkKZW5kKQoKaWYgc3VjY2VzcyB0aGVuCiAgICAgICAgUmVkZWVtZWRDb2Rlc1tjb2RlXSA9IHRydWUKICAgICAgICBOb3RpZnkoIuKchSBSZWRlZW06ICIuLmNvZGUsIDIpCiAgICBlbHNlCiAgICAgICAgTm90aWZ5KCLinYwgRmFpbDogIi4uY29kZSwgMikKICAgIGVuZAplbmQKCkNoZWVtLlNtYXJ0VjQgPSBDaGVlbS5TbWFydFY0IG9yIGZhbHNlCkNoZWVtLkF1dG9Ib3AgPSBDaGVlbS5BdXRvSG9wIG9yIGZhbHNlCkNoZWVtLkF1dG9CbHVlR2VhciA9IENoZWVtLkF1dG9CbHVlR2VhciBvciBmYWxzZQpDaGVlbS5Ib3BNb2RlID0gQ2hlZW0uSG9wTW9kZSBvciAiTm9uZSIKCmxvY2FsIERlZmF1bHRDb25maWcgPSB7CiAgICBBdXRvRmFybSA9IGZhbHNlLAogICAgV2VhcG9uID0gIk1lbGVlIiwKICAgIFRlbGVwb3J0ID0gdHJ1ZSwKICAgIEF1dG9FcXVpcCA9IHRydWUsCgogICAgQXV0b0hvcCA9IGZhbHNlLAogICAgSG9wTW9kZSA9ICJOb25lIiwKICAgIEF1dG9CbHVlR2VhciA9IGZhbHNlCn0KCi0tPT09PT09PT09PT09PT09PT09PT09PSBBTlRJIEFGSyA9PT09PT09PT09PT09PT09PT09PT09LS0KUGxheWVyLklkbGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgVmlydHVhbFVzZXI6QnV0dG9uMkRvd24oVmVjdG9yMi5uZXcoMCwwKSwgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lKQogICAgdGFzay53YWl0KDEpCiAgICBWaXJ0dWFsVXNlcjpCdXR0b24yVXAoVmVjdG9yMi5uZXcoMCwwKSwgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lKQoKLS09PT09PT09PT09PT09PT09PT09PT09IFVUSUxTID09PT09PT09PT09PT09PT09PT09PT0tLQpsb2NhbCBmdW5jdGlvbiBUUChjZikKICAgIGlmIG5vdCBDaGVlbS5UZWxlcG9ydCB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIGhycCA9IFBsYXllci5DaGFyYWN0ZXIgYW5kIFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgaWYgaHJwIHRoZW4KICAgICAgICBocnAuQ0ZyYW1lID0gY2YKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIEVxdWlwV2VhcG9uKCkKICAgIGlmIG5vdCBDaGVlbS5BdXRvRXF1aXAgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICBmb3IgXyx0b29sIGluIHBhaXJzKFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICBjaGFyLkh1bWFub2lkOkVxdWlwVG9vbCh0b29sKQogICAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgZW5kCmVuZAoKLS09PT09PT09PT09PT09PT09PT09PT09IEZBUk0gQk9ORVMgTE9PUCAoQ09ORklHIE1PREUpID09PT09PT09PT09PT09PT09PT09PT0tLQoKbG9jYWwgQm9uZXNNb2JzID0gewogICAgIlJlYm9ybiBTa2VsZXRvbiIsCiAgICAiTGl2aW5nIFpvbWJpZSIsCiAgICAiRGVtb25pYyBTb3VsIiwKICAgICJQb3Nlc3NlZCBNdW1teSIKfQoKLS0gSGF1bnRlZCBDYXN0bGUgKFNlYSAzKQpsb2NhbCBCb25lc0Zhcm1DRiA9IENGcmFtZS5uZXcoLTk1MTUsIDE0MiwgNTUzNSkKCmxvY2FsIGZ1bmN0aW9uIElzQm9uZXNNb2IobmFtZSkKICAgIGZvciBfLHYgaW4gaXBhaXJzKEJvbmVzTW9icykgZG8KICAgICAgICBpZiBuYW1lID09IHYgdGhlbiByZXR1cm4gdHJ1ZSBlbmQKICAgIGVuZAogICAgcmV0dXJuIGZhbHNlCmVuZAoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoMC4yNSkgZG8KICAgICAgICAgICBUcnlFbmFibGVWMygpCiAgICAgICAgICAgVHJ5RW5hYmxlVjQoKQogICAgICAgIAogICAgICAgIC0tIOKdjCBLSMOUTkcgxJHDum5nIG1vZGUg4oaSIGLhu48KICAgICAgICBpZiBDaGVlbS5GYXJtTW9kZSB+PSAiQm9uZXMiIHRoZW4gY29udGludWUgZW5kCiAgICAgICAgaWYgbm90IENoZWVtLkF1dG9GYXJtQm9uZXMgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICBpZiBnYW1lLlBsYWNlSWQgfj0gNzQ0OTQyMzYzNSB0aGVuIGNvbnRpbnVlIGVuZCAtLSBjaOG7iSBTZWEgMwoKICAgICAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIGhycCA9IGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGxvY2FsIGh1bSA9IGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgaWYgbm90IGhycCBvciBub3QgaHVtIG9yIGh1bS5IZWFsdGggPD0gMCB0aGVuIGNvbnRpbnVlIGVuZAoKICAgICAgICAtLSBBdXRvIFRQIEhhdW50ZWQgQ2FzdGxlCiAgICAgICAgaWYgKGhycC5Qb3NpdGlvbiAtIEJvbmVzRmFybUNGLlBvc2l0aW9uKS5NYWduaXR1ZGUgPiAxMjAwIHRoZW4KICAgIFRQKEJvbmVzRmFybUNGKQogICAgdGFzay53YWl0KDAuNSkKZW5kCgogICAgICAgIGxvY2FsIGVuZW1pZXMgPSB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIkVuZW1pZXMiKQogICAgICAgIGlmIG5vdCBlbmVtaWVzIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIGZvciBfLG1vYiBpbiBwYWlycyhlbmVtaWVzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIG5vdCBDaGVlbS5BdXRvRmFybUJvbmVzIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgIGlmIENoZWVtLkZhcm1Nb2RlIH49ICJCb25lcyIgdGhlbiBicmVhayBlbmQKCiAgICAgICAgICAgIGlmIG1vYjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICBhbmQgbW9iOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgYW5kIG1vYi5IdW1hbm9pZC5IZWFsdGggPiAwCiAgICAgICAgICAgIGFuZCBJc0JvbmVzTW9iKG1vYi5OYW1lKSB0aGVuCgogICAgICAgICAgICAgICAgYXR0YWNraW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgRXF1aXBGYXJtV2VhcG9uKCkKCiAgICAgICAgICAgICAgICAtLSBNb2IgTWFnbmV0CiAgICAgICAgICAgICAgICBpZiBDaGVlbS5Nb2JNYWduZXQgdGhlbgogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgbW9iLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhycC5DRnJhbWUgKiBDRnJhbWUubmV3KG1hdGgucmFuZG9tKC0zLDMpLDAsbWF0aC5yYW5kb20oLTMsMykpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaHJwLkNGcmFtZSA9IG1vYi5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgMTAsIDApCgogICAgICAgICAgICAgICAgaWYgQ2hlZW0uRmFzdEF0dGFjayB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgPSAxLDUgZG8KICAgICAgICAgICAgICAgICAgICAgICAgVmlydHVhbFVzZXI6QnV0dG9uMURvd24oVmVjdG9yMi5uZXcoMCwwKSkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFVcChWZWN0b3IyLm5ldygwLDApKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFEb3duKFZlY3RvcjIubmV3KDAsMCkpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgICAgICBWaXJ0dWFsVXNlcjpCdXR0b24xVXAoVmVjdG9yMi5uZXcoMCwwKSkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGF0dGFja2luZyA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tPT09PT09PT09PT09PT09PT09PT0gRU5EIEZBUk0gQk9ORVMgPT09PT09PT09PT09PT09PT09PT0tLQoKLS0gPT09PT09PT0gSMOATSBU4buwIFRQIEZBUk0gQk9ORVMgPT09PT09PQpsb2NhbCBmdW5jdGlvbiBUUFRvQm9uZXMoKQogICAgaWYgZ2FtZS5QbGFjZUlkIH49IDc0NDk0MjM2MzUgdGhlbiByZXR1cm4gZW5kIC0tIGNo4buJIFNlYSAzCiAgICBUUChCb25lc0Zhcm1DRikKZW5kCgotLT09PT09PT09PT09PT09PT09PT09PT0gUVVFU1QgREFUQSAoU0VBIDEpID09PT09PT09PT09PT09PT09PT09PT0tLQpsb2NhbCBRdWVzdERhdGEgPSB7CgogICAgLS0gU1RBUlQgSVNMQU5ECiAgICB7CiAgICAgICAgTWluID0gMSwgTWF4ID0gOSwKICAgICAgICBRdWVzdE5hbWUgPSAiQmFuZGl0UXVlc3QxIiwKICAgICAgICBRdWVzdExldmVsID0gMSwKICAgICAgICBNb2JOYW1lID0gIkJhbmRpdCIsCiAgICAgICAgSXNsYW5kUG9zID0gQ0ZyYW1lLm5ldygxMDYwLCAxNiwgMTU0NykKICAgIH0sCiAgICB7CiAgICAgICAgTWluID0gMTAsIE1heCA9IDE0LAogICAgICAgIFF1ZXN0TmFtZSA9ICJCYW5kaXRRdWVzdDEiLAogICAgICAgIFF1ZXN0TGV2ZWwgPSAyLAogICAgICAgIE1vYk5hbWUgPSAiTW9ua2V5IiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KC0xNjAwLCAzNiwgMTUwKQogICAgfSwKCiAgICAtLSBKVU5HTEUKICAgIHsKICAgICAgICBNaW4gPSAxNSwgTWF4ID0gMjksCiAgICAgICAgUXVlc3ROYW1lID0gIkp1bmdsZVF1ZXN0IiwKICAgICAgICBRdWVzdExldmVsID0gMSwKICAgICAgICBNb2JOYW1lID0gIkdvcmlsbGEiLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoLTE2MDAsIDM2LCAxNTApCiAgICB9LAogICAgewogICAgICAgIE1pbiA9IDMwLCBNYXggPSAzOSwKICAgICAgICBRdWVzdE5hbWUgPSAiSnVuZ2xlUXVlc3QiLAogICAgICAgIFF1ZXN0TGV2ZWwgPSAyLAogICAgICAgIE1vYk5hbWUgPSAiR29yaWxsYSBLaW5nIiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KC0xNjAwLCAzNiwgMTUwKQogICAgfSwKCiAgICAtLSBQSVJBVEUgVklMTEFHRQogICAgewogICAgICAgIE1pbiA9IDQwLCBNYXggPSA1OSwKICAgICAgICBRdWVzdE5hbWUgPSAiQnVnZ3lRdWVzdDEiLAogICAgICAgIFF1ZXN0TGV2ZWwgPSAxLAogICAgICAgIE1vYk5hbWUgPSAiUGlyYXRlIiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KC0xMTAwLCAxMywgMzgwMCkKICAgIH0sCiAgICB7CiAgICAgICAgTWluID0gNjAsIE1heCA9IDc0LAogICAgICAgIFF1ZXN0TmFtZSA9ICJCdWdneVF1ZXN0MSIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDIsCiAgICAgICAgTW9iTmFtZSA9ICJCcnV0ZSIsCiAgICAgICAgSXNsYW5kUG9zID0gQ0ZyYW1lLm5ldygtMTEwMCwgMTMsIDM4MDApCiAgICB9LAoKICAgIC0tIERFU0VSVAogICAgewogICAgICAgIE1pbiA9IDc1LCBNYXggPSA4OSwKICAgICAgICBRdWVzdE5hbWUgPSAiRGVzZXJ0UXVlc3QiLAogICAgICAgIFF1ZXN0TGV2ZWwgPSAxLAogICAgICAgIE1vYk5hbWUgPSAiRGVzZXJ0IEJhbmRpdCIsCiAgICAgICAgSXNsYW5kUG9zID0gQ0ZyYW1lLm5ldyg5MzAsIDcsIDQ0ODApCiAgICB9LAogICAgewogICAgICAgIE1pbiA9IDkwLCBNYXggPSA5OSwKICAgICAgICBRdWVzdE5hbWUgPSAiRGVzZXJ0UXVlc3QiLAogICAgICAgIFF1ZXN0TGV2ZWwgPSAyLAogICAgICAgIE1vYk5hbWUgPSAiRGVzZXJ0IE9mZmljZXIiLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoOTMwLCA3LCA0NDgwKQogICAgfSwKCiAgICAtLSBGUk9aRU4gVklMTEFHRQogICAgewogICAgICAgIE1pbiA9IDEwMCwgTWF4ID0gMTE5LAogICAgICAgIFF1ZXN0TmFtZSA9ICJTbm93UXVlc3QiLAogICAgICAgIFF1ZXN0TGV2ZWwgPSAxLAogICAgICAgIE1vYk5hbWUgPSAiU25vdyBCYW5kaXQiLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoMTM4MCwgODcsIC0xMjkwKQogICAgfSwKICAgIHsKICAgICAgICBNaW4gPSAxMjAsIE1heCA9IDE0OSwKICAgICAgICBRdWVzdE5hbWUgPSAiU25vd1F1ZXN0IiwKICAgICAgICBRdWVzdExldmVsID0gMiwKICAgICAgICBNb2JOYW1lID0gIlNub3dtYW4iLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoMTM4MCwgODcsIC0xMjkwKQogICAgfSwKCiAgICAtLSBNQVJJTkVGT1JECiAgICB7CiAgICAgICAgTWluID0gMTUwLCBNYXggPSAxNzQsCiAgICAgICAgUXVlc3ROYW1lID0gIk1hcmluZVF1ZXN0MiIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDEsCiAgICAgICAgTW9iTmFtZSA9ICJDaGllZiBQZXR0eSBPZmZpY2VyIiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KC01MDMwLCAyOSwgNDMyNSkKICAgIH0sCiAgICB7CiAgICAgICAgTWluID0gMTc1LCBNYXggPSAxODksCiAgICAgICAgUXVlc3ROYW1lID0gIk1hcmluZVF1ZXN0MiIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDIsCiAgICAgICAgTW9iTmFtZSA9ICJTa3kgQmFuZGl0IiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KC01MDMwLCAyOSwgNDMyNSkKICAgIH0sCgogICAgLS0gU0tZIElTTEFORAogICAgewogICAgICAgIE1pbiA9IDE5MCwgTWF4ID0gMjA5LAogICAgICAgIFF1ZXN0TmFtZSA9ICJTa3lRdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDEsCiAgICAgICAgTW9iTmFtZSA9ICJEYXJrIE1hc3RlciIsCiAgICAgICAgSXNsYW5kUG9zID0gQ0ZyYW1lLm5ldygtNDg1MCwgNzE3LCAtMjYyMCkKICAgIH0sCgogICAgLS0gUFJJU09OCiAgICB7CiAgICAgICAgTWluID0gMjEwLCBNYXggPSAyNDksCiAgICAgICAgUXVlc3ROYW1lID0gIlByaXNvblF1ZXN0IiwKICAgICAgICBRdWVzdExldmVsID0gMSwKICAgICAgICBNb2JOYW1lID0gIlByaXNvbmVyIiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KDQ4NTAsIDUsIDczNSkKICAgIH0sCgogICAgLS0gQ09MT1NTRVVNCiAgICB7CiAgICAgICAgTWluID0gMjUwLCBNYXggPSAyOTksCiAgICAgICAgUXVlc3ROYW1lID0gIkNvbG9zc2V1bVF1ZXN0IiwKICAgICAgICBRdWVzdExldmVsID0gMSwKICAgICAgICBNb2JOYW1lID0gIlRvZ2EgV2FycmlvciIsCiAgICAgICAgSXNsYW5kUG9zID0gQ0ZyYW1lLm5ldygtMTUwMCwgNywgLTMwMDApCiAgICB9LAoKICAgIC0tIE1BR01BIFZJTExBR0UKICAgIHsKICAgICAgICBNaW4gPSAzMDAsIE1heCA9IDMyNCwKICAgICAgICBRdWVzdE5hbWUgPSAiTWFnbWFRdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDEsCiAgICAgICAgTW9iTmFtZSA9ICJNaWxpdGFyeSBTb2xkaWVyIiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KC01MjUwLCA4LCA4NTAwKQogICAgfSwKICAgIHsKICAgICAgICBNaW4gPSAzMjUsIE1heCA9IDM3NCwKICAgICAgICBRdWVzdE5hbWUgPSAiTWFnbWFRdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDIsCiAgICAgICAgTW9iTmFtZSA9ICJNaWxpdGFyeSBTcHkiLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoLTUyNTAsIDgsIDg1MDApCiAgICB9LAoKICAgIC0tIEZJU0hNQU4gSVNMQU5ECiAgICB7CiAgICAgICAgTWluID0gMzc1LCBNYXggPSAzOTksCiAgICAgICAgUXVlc3ROYW1lID0gIkZpc2htYW5RdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDEsCiAgICAgICAgTW9iTmFtZSA9ICJGaXNobWFuIFdhcnJpb3IiLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoNjEwMDAsIDE4LCAxNTYwKQogICAgfSwKICAgIHsKICAgICAgICBNaW4gPSA0MDAsIE1heCA9IDQ0OSwKICAgICAgICBRdWVzdE5hbWUgPSAiRmlzaG1hblF1ZXN0IiwKICAgICAgICBRdWVzdExldmVsID0gMiwKICAgICAgICBNb2JOYW1lID0gIkZpc2htYW4gQ29tbWFuZG8iLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoNjEwMDAsIDE4LCAxNTYwKQogICAgfSwKCiAgICAtLSBTS1lQSUVBCiAgICB7CiAgICAgICAgTWluID0gNDUwLCBNYXggPSA0NzQsCiAgICAgICAgUXVlc3ROYW1lID0gIlNreUV4cDFRdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDEsCiAgICAgICAgTW9iTmFtZSA9ICJHb2QncyBHdWFyZCIsCiAgICAgICAgSXNsYW5kUG9zID0gQ0ZyYW1lLm5ldygtNDcyMCwgODQ1LCAtMTk1MCkKICAgIH0sCiAgICB7CiAgICAgICAgTWluID0gNDc1LCBNYXggPSA1MjQsCiAgICAgICAgUXVlc3ROYW1lID0gIlNreUV4cDFRdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDIsCiAgICAgICAgTW9iTmFtZSA9ICJTaGFuZGEiLAogICAgICAgIElzbGFuZFBvcyA9IENGcmFtZS5uZXcoLTQ3MjAsIDg0NSwgLTE5NTApCiAgICB9LAoKICAgIC0tIEZPVU5UQUlOIENJVFkKICAgIHsKICAgICAgICBNaW4gPSA1MjUsIE1heCA9IDcwMCwKICAgICAgICBRdWVzdE5hbWUgPSAiRm91bnRhaW5RdWVzdCIsCiAgICAgICAgUXVlc3RMZXZlbCA9IDEsCiAgICAgICAgTW9iTmFtZSA9ICJHYWxsZXkgUGlyYXRlIiwKICAgICAgICBJc2xhbmRQb3MgPSBDRnJhbWUubmV3KDUyNTAsIDM5LCA0MDUwKQogICAgfQp9Cgpsb2NhbCBmdW5jdGlvbiBHZXRRdWVzdChsdikKICAgIGZvciBfLHEgaW4gcGFpcnMoUXVlc3REYXRhKSBkbwogICAgICAgIGlmIGx2Pj1xLk1pbiBhbmQgbHY8PXEuTWF4IHRoZW4KICAgICAgICAgICAgcmV0dXJuIHEKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tPT09PT09PT09PT09PT09PT09PT09PSBGQVJNIEVGRkVDVCA9PT09PT09PT09PT09PT09PT09PT09LS0KbG9jYWwgZnVuY3Rpb24gRW5hYmxlRmFybUVmZmVjdCgpCiAgICBsb2NhbCBjaGFyID0gUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICBpZiBjaGFyOkZpbmRGaXJzdENoaWxkKCJDaGVlbUhpZ2hsaWdodCIpIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIGhsID0gSW5zdGFuY2UubmV3KCJIaWdobGlnaHQiKQogICAgaGwuTmFtZSA9ICJDaGVlbUhpZ2hsaWdodCIKICAgIGhsLlBhcmVudCA9IGNoYXIKICAgIGhsLkFkb3JuZWUgPSBjaGFyCgogICAgaGwuRmlsbENvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyMjEsIDApICAgICAgLS0g8J+foSB2w6BuZwogICAgaGwuT3V0bGluZUNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIGhsLkZpbGxUcmFuc3BhcmVuY3kgPSAwLjYKICAgIGhsLk91dGxpbmVUcmFuc3BhcmVuY3kgPSAwCmVuZAoKbG9jYWwgZnVuY3Rpb24gRGlzYWJsZUZhcm1FZmZlY3QoKQogICAgbG9jYWwgY2hhciA9IFBsYXllci5DaGFyYWN0ZXIKICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIGhsID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiQ2hlZW1IaWdobGlnaHQiKQogICAgaWYgaGwgdGhlbgogICAgICAgIGhsOkRlc3Ryb3koKQogICAgZW5kCmVuZAoKLS0tPT09PT09PT09PT09PT09IEZBTExCQUNLIE9SSU9OIFVJID09PT09PT09PT09PT09PT09LS0KbG9jYWwgZnVuY3Rpb24gTG9hZEZhbGxiYWNrVUkoKQogICAgd2FybigiW0ZBTExCQUNLIFVJIEFDVElWRV0iLCBlcnIpCgogICAgbG9jYWwgT3Jpb25MaWIKICAgIGxvY2FsIG9rID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIE9yaW9uTGliID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoCiAgICAgICAgICAgICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc2hsZXh3YXJlL09yaW9uL21haW4vc291cmNlIgogICAgICAgICkpKCkKICAgIGVuZCkKCiAgICBpZiBub3Qgb2sgb3Igbm90IE9yaW9uTGliIHRoZW4KICAgICAgICB3YXJuKCJGYWlsZWQgdG8gbG9hZCBPcmlvbkxpYiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBXaW5kb3cgPSBPcmlvbkxpYjpNYWtlV2luZG93KHsKICAgICAgICBOYW1lID0gIkNoZWVtIEh1YiB8IEZhbGxiYWNrIE1vZGUiLAogICAgICAgIEhpZGVQcmVtaXVtID0gZmFsc2UsCiAgICAgICAgU2F2ZUNvbmZpZyA9IGZhbHNlLAogICAgICAgIEludHJvRW5hYmxlZCA9IGZhbHNlCiAgICB9KQoKICAgIGxvY2FsIFRhYiA9IFdpbmRvdzpNYWtlVGFiKHsKICAgICAgICBOYW1lID0gIkVtZXJnZW5jeSIsCiAgICAgICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNDQ4MzM0NTk5OCIsCiAgICAgICAgUHJlbWl1bU9ubHkgPSBmYWxzZQogICAgfSkKCiAgICBUYWI6QWRkUGFyYWdyYXBoKAogICAgIlNZU1RFTSBOT1RJQ0UiLAogICAgIkjhu4cgdGjhu5FuZyBVSSDEkWFuZyDEkcaw4bujYyBjaHV54buDbiBzYW5nIGNo4bq/IMSR4buZIGFuIHRvw6BuLlxuTeG7mXQgc+G7kSBoaeG7h3Ug4bupbmcgY8OzIHRo4buDIGLhu4sgZ2nhu5tpIGjhuqFuLiIKKQoKICAgIC0tID09PT09IFRvZ2dsZSBjxqEgYuG6o24gZ2nhu68gY2jhu6ljIG7Eg25nID09PT09CiAgICBUYWI6QWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gIkF1dG8gRmFybSIsCiAgICAgICAgRGVmYXVsdCA9IENoZWVtIGFuZCBDaGVlbS5BdXRvRmFybSBvciBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgICAgIENoZWVtLkF1dG9GYXJtID0gdgogICAgICAgIGVuZAogICAgfSkKCiAgICBUYWI6QWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gIkZhc3QgQXR0YWNrIiwKICAgICAgICBEZWZhdWx0ID0gQ2hlZW0gYW5kIENoZWVtLkZhc3RBdHRhY2sgb3IgZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgICAgICBDaGVlbS5GYXN0QXR0YWNrID0gdgogICAgICAgIGVuZAogICAgfSkKCiAgICBUYWI6QWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gIkF1dG8gQ2xpY2siLAogICAgICAgIERlZmF1bHQgPSBDaGVlbSBhbmQgQ2hlZW0uQXV0b0NsaWNrIG9yIGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odikKICAgICAgICAgICAgQ2hlZW0uQXV0b0NsaWNrID0gdgogICAgICAgIGVuZAogICAgfSkKCiAgICAtLSA9PT09PSBFWFBPU0UgVE9HR0xFIENITyBJQ09OID09PT09CiAgICBfRy5GYWxsYmFja1RvZ2dsZSA9IGZ1bmN0aW9uKCkKICAgICAgICBPcmlvbkxpYjpUb2dnbGVVSSgpCiAgICBlbmQKZW5kCi0tPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLUNIRUVNIEhVQiBVSSBMT0FERVIgOTkuOSUgKE5PIEVBUkxZIEZBTExCQUNLKQotLT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCnJlcGVhdCB0YXNrLndhaXQoKSB1bnRpbCBnYW1lOklzTG9hZGVkKCkKdGFzay53YWl0KDAuNikKCmxvY2FsIENvcmVHdWkgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKQoKbG9jYWwgZnVuY3Rpb24gQ29yZUd1aVJlYWR5KCkKICAgIGxvY2FsIG9rID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGcgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICAgICAgZy5OYW1lID0gIl9fdGVzdCIKICAgICAgICBnLlBhcmVudCA9IENvcmVHdWkKICAgICAgICBnOkRlc3Ryb3koKQogICAgZW5kKQogICAgcmV0dXJuIG9rCmVuZAoKcmVwZWF0IHRhc2sud2FpdCgwLjI1KSB1bnRpbCBDb3JlR3VpUmVhZHkoKQoKLS0gZGVzdHJveSBvbGQgc2FmZWx5CnBjYWxsKGZ1bmN0aW9uKCkKICAgIGxvY2FsIG9sZCA9IENvcmVHdWk6RmluZEZpcnN0Q2hpbGQoIkNoZWVtX1VJIikKICAgIGlmIG9sZCB0aGVuIG9sZDpEZXN0cm95KCkgZW5kCiAgICBsb2NhbCBvbGRJY29uID0gQ29yZUd1aTpGaW5kRmlyc3RDaGlsZCgiQ2hlZW1fSWNvbiIpCiAgICBpZiBvbGRJY29uIHRoZW4gb2xkSWNvbjpEZXN0cm95KCkgZW5kCmVuZCkKCl9HLlVJX1JFQUxfQlJPS0VOID0gZmFsc2UKCmxvY2FsIGZ1bmN0aW9uIExvYWRNYWluVUkoKQotLT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0gQ0hFRU0gQ0xFQU4gVUkgTElCUkFSWSAoREFSSyBUSEVNRSkKLS0gMSBJY29uIOKAkyAxIFVJIHwgU2xpZGUgVG9nZ2xlIHwgVGFicwotLSBOTyBPUklPTiB8IE5PIFNFUlZJQ0UgfCBOTyBMT0dJQwotLT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmxvY2FsIFR3ZWVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIikKbG9jYWwgVUlTID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKbG9jYWwgQ29yZUd1aSA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCgpsb2NhbCBVSSA9IHt9ClVJLl9faW5kZXggPSBVSQoKLS09PT09PT09PT09PT09PT09IElDT04gVE9HR0xFID09PT09PT09PT09PT09PT09LS0KbG9jYWwgVUlWaXNpYmxlID0gdHJ1ZQoKcGNhbGwoZnVuY3Rpb24oKQogICAgbG9jYWwgY2cgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKQogICAgbG9jYWwgb2xkID0gY2c6RmluZEZpcnN0Q2hpbGQoIkNoZWVtX0ljb24iKQogICAgaWYgb2xkIHRoZW4gb2xkOkRlc3Ryb3koKSBlbmQKZW5kKQoKbG9jYWwgSWNvbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKSWNvbkd1aS5OYW1lID0gIkNoZWVtX0ljb24iCkljb25HdWkuUmVzZXRPblNwYXduID0gZmFsc2UKSWNvbkd1aS5QYXJlbnQgPSBDb3JlR3VpCgpsb2NhbCBJY29uID0gSW5zdGFuY2UubmV3KCJJbWFnZUJ1dHRvbiIpCkljb24uUGFyZW50ID0gSWNvbkd1aQpJY29uLlNpemUgPSBVRGltMi5mcm9tT2Zmc2V0KDUwLDUwKQpJY29uLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTUsMC40NSwwKQpJY29uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCkljb24uSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzkxMzExNzE3NjI1NDg3IgpJY29uLkltYWdlQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDIyMSwwKQoKLS0gZHJhZyBpY29uCmxvY2FsIGRyYWcsIGRTdGFydCwgZFBvcwpJY29uLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpKQoJaWYgaS5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgdGhlbgoJCWRyYWcgPSB0cnVlCgkJZFN0YXJ0ID0gaS5Qb3NpdGlvbgoJCWRQb3MgPSBJY29uLlBvc2l0aW9uCgllbmQKZW5kKQoKVUlTLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGkpCglpZiBkcmFnIGFuZCBpLlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgdGhlbgoJCWxvY2FsIGQgPSBpLlBvc2l0aW9uIC0gZFN0YXJ0CgkJSWNvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygKCQkJZFBvcy5YLlNjYWxlLCBkUG9zLlguT2Zmc2V0ICsgZC5YLAoJCQlkUG9zLlkuU2NhbGUsIGRQb3MuWS5PZmZzZXQgKyBkLlkKCQkpCgllbmQKZW5kKQoKVUlTLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpKQoJaWYgaS5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgdGhlbgoJCWRyYWcgPSBmYWxzZQoJZW5kCmVuZCkKCi0tPT09PT09PT09PT09PT09PSBNQUlOIFVJID09PT09PT09PT09PT09PT09LS0KZnVuY3Rpb24gVUk6Q3JlYXRlV2luZG93KHRpdGxlKQoJbG9jYWwgR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQoJR3VpLk5hbWUgPSAiQ2hlZW1fVUkiCglHdWkuUmVzZXRPblNwYXduID0gZmFsc2UKCUd1aS5QYXJlbnQgPSBDb3JlR3VpCgogICAgX0cuTWFpbkd1aSA9IEd1aQoKCS0tIElDT04gQ0xJQ0sgKENI4buIIEfhuq5OIDEgTOG6pk4pCmlmIG5vdCBJY29uLl9CaW5kZWQgdGhlbgogICAgSWNvbi5fQmluZGVkID0gdHJ1ZQogICAgSWNvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiBfRy5VSV9SRUFMX0JST0tFTiBhbmQgX0cuRmFsbGJhY2tUb2dnbGUgdGhlbgogICAgICAgICAgICBfRy5GYWxsYmFja1RvZ2dsZSgpCiAgICAgICAgZWxzZQogICAgICAgICAgICBVSVZpc2libGUgPSBub3QgVUlWaXNpYmxlCiAgICAgICAgICAgIGlmIF9HLk1haW5HdWkgdGhlbgogICAgICAgICAgICAgICAgX0cuTWFpbkd1aS5FbmFibGVkID0gVUlWaXNpYmxlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kKQplbmQKCglsb2NhbCBNYWluID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIEd1aSkKCU1haW4uU2l6ZSA9IFVEaW0yLmZyb21PZmZzZXQoNTYwLDM0MCkKCU1haW4uUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LC0yODAsMC41LC0xNzApCglNYWluLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMCwyMCwyMCkKCU1haW4uQm9yZGVyU2l6ZVBpeGVsID0gMAoJSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIE1haW4pLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsMTIpCgoJLS0gZHJhZyB3aW5kb3cKCWxvY2FsIHdEcmFnLCB3U3RhcnQsIHdQb3MKCU1haW4uSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGkpCgkJaWYgaS5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgdGhlbgoJCQl3RHJhZyA9IHRydWUKCQkJd1N0YXJ0ID0gaS5Qb3NpdGlvbgoJCQl3UG9zID0gTWFpbi5Qb3NpdGlvbgoJCWVuZAoJZW5kKQoKCVVJUy5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpKQoJCWlmIHdEcmFnIGFuZCBpLlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgdGhlbgoJCQlsb2NhbCBkID0gaS5Qb3NpdGlvbiAtIHdTdGFydAoJCQlNYWluLlBvc2l0aW9uID0gVURpbTIubmV3KAoJCQkJd1Bvcy5YLlNjYWxlLCB3UG9zLlguT2Zmc2V0ICsgZC5YLAoJCQkJd1Bvcy5ZLlNjYWxlLCB3UG9zLlkuT2Zmc2V0ICsgZC5ZCgkJCSkKCQllbmQKCWVuZCkKCglVSVMuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGkpCgkJaWYgaS5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgdGhlbgoJCQl3RHJhZyA9IGZhbHNlCgkJZW5kCgllbmQpCgoJLS0gdGl0bGUKCWxvY2FsIFRpdGxlID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBNYWluKQoJVGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMCw0MCkKCVRpdGxlLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCglUaXRsZS5UZXh0ID0gdGl0bGUgb3IgIkNoZWVtIEh1YiBbUHJlbWl1bV0gYnkgT2xpb3MiCglUaXRsZS5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKCVRpdGxlLlRleHRTaXplID0gMTgKCVRpdGxlLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsMjIxLDApCgoJLS0gdGFicwoJbG9jYWwgVGFicyA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBNYWluKQoJVGFicy5TaXplID0gVURpbTIubmV3KDAsMTQwLDEsLTQwKQoJVGFicy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCw0MCkKCVRhYnMuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE1LDE1LDE1KQoKCWxvY2FsIFBhZ2VzID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIE1haW4pCglQYWdlcy5TaXplID0gVURpbTIubmV3KDEsLTE0MCwxLC00MCkKCVBhZ2VzLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTQwLDAsNDApCglQYWdlcy5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQoKCWxvY2FsIFdpbmRvdyA9IHtUYWJzPXt9LCBQYWdlcz17fSwgQ3VycmVudD1uaWx9CgoJLS09PT09PT09PT09PT09PT09IFRBQiA9PT09PT09PT09PT09PT09PS0tCglmdW5jdGlvbiBXaW5kb3c6Q3JlYXRlVGFiKG5hbWUpCgkJbG9jYWwgQnRuID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgVGFicykKCQlCdG4uU2l6ZSA9IFVEaW0yLm5ldygxLDAsMCw0MCkKCQlCdG4uVGV4dCA9IG5hbWUKCQlCdG4uRm9udCA9IEVudW0uRm9udC5Hb3RoYW0KCQlCdG4uVGV4dFNpemUgPSAxNAoJCUJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLm5ldygxLDEsMSkKCQlCdG4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDMwLDMwLDMwKQoJCUJ0bi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQoKCQlsb2NhbCBQYWdlID0gSW5zdGFuY2UubmV3KCJTY3JvbGxpbmdGcmFtZSIsIFBhZ2VzKQoJCVBhZ2UuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMSwwKQoJCVBhZ2UuU2Nyb2xsQmFySW1hZ2VUcmFuc3BhcmVuY3kgPSAxCgkJUGFnZS5WaXNpYmxlID0gZmFsc2UKCQlQYWdlLkF1dG9tYXRpY0NhbnZhc1NpemUgPSBFbnVtLkF1dG9tYXRpY1NpemUuWQoKCQlsb2NhbCBsaXN0ID0gSW5zdGFuY2UubmV3KCJVSUxpc3RMYXlvdXQiLCBQYWdlKQoJCWxpc3QuUGFkZGluZyA9IFVEaW0ubmV3KDAsMTApCgoJCUJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGZvciBfLHAgaW4gcGFpcnMoV2luZG93LlBhZ2VzKSBkbyBwLlZpc2libGU9ZmFsc2UgZW5kCiAgICBmb3IgXyx0IGluIHBhaXJzKFdpbmRvdy5UYWJzKSBkbyB0LkJhY2tncm91bmRDb2xvcjM9Q29sb3IzLmZyb21SR0IoMzAsMzAsMzApIGVuZAogICAgQnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig0NSw0NSw0NSkKICAgIFBhZ2UuVmlzaWJsZSA9IHRydWUKICAgIFdpbmRvdy5DdXJyZW50ID0gUGFnZQplbmQpCgogICAgICAgIHRhYmxlLmluc2VydChXaW5kb3cuVGFicywgQnRuKQogICAgICAgIHRhYmxlLmluc2VydChXaW5kb3cuUGFnZXMsIFBhZ2UpCgoJCWlmIG5vdCBXaW5kb3cuQ3VycmVudCB0aGVuCgkJCUJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNDUsNDUsNDUpCgkJCVBhZ2UuVmlzaWJsZSA9IHRydWUKCQkJV2luZG93LkN1cnJlbnQgPSBQYWdlCgkJZW5kCgoJCWxvY2FsIFRhYiA9IHt9CgoJCS0tPT09PT09PT09PT0gU0xJREUgVE9HR0xFID09PT09PT09PT09CgkJZnVuY3Rpb24gVGFiOkFkZFNsaWRlcihvcHQpCiAgICBsb2NhbCBIID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIFBhZ2UpCiAgICBILlNpemUgPSBVRGltMi5uZXcoMSwtMTAsMCw1MCkKICAgIEguQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDM1LDM1LDM1KQogICAgSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIEgpLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsOCkKCiAgICBsb2NhbCBMID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBIKQogICAgTC5TaXplID0gVURpbTIubmV3KDEsLTIwLDAsMjApCiAgICBMLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTAsMCwwKQogICAgTC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgTC5UZXh0ID0gb3B0Lk5hbWUuLiIgOiAiLi50b3N0cmluZyhvcHQuRGVmYXVsdCBvciBvcHQuTWluKQogICAgTC5Gb250ID0gRW51bS5Gb250LkdvdGhhbQogICAgTC5UZXh0U2l6ZSA9IDE0CiAgICBMLlRleHRDb2xvcjMgPSBDb2xvcjMubmV3KDEsMSwxKQogICAgTC5UZXh0WEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuTGVmdAoKICAgIGxvY2FsIEJhciA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBIKQogICAgQmFyLlNpemUgPSBVRGltMi5uZXcoMSwtMjAsMCw4KQogICAgQmFyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTAsMCwzMCkKICAgIEJhci5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNjAsNjAsNjApCiAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgQmFyKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLDApCgogICAgbG9jYWwgRmlsbCA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBCYXIpCiAgICBGaWxsLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsMjIxLDApCiAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgRmlsbCkuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMSwwKQoKICAgIGxvY2FsIG1pbiA9IG9wdC5NaW4gb3IgMAogICAgbG9jYWwgbWF4ID0gb3B0Lk1heCBvciAxMDAKICAgIGxvY2FsIHZhbHVlID0gb3B0LkRlZmF1bHQgb3IgbWluCgogICAgbG9jYWwgZnVuY3Rpb24gc2V0VmFsKHYpCiAgICAgICAgdmFsdWUgPSBtYXRoLmNsYW1wKHYsIG1pbiwgbWF4KQogICAgICAgIGxvY2FsIHBjdCA9ICh2YWx1ZSAtIG1pbikgLyAobWF4IC0gbWluKQogICAgICAgIEZpbGwuU2l6ZSA9IFVEaW0yLm5ldyhwY3QsMCwxLDApCiAgICAgICAgTC5UZXh0ID0gb3B0Lk5hbWUuLiIgOiAiLi5tYXRoLmZsb29yKHZhbHVlKQogICAgICAgIGlmIG9wdC5DYWxsYmFjayB0aGVuCiAgICAgICAgICAgIG9wdC5DYWxsYmFjayh2YWx1ZSkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHNldFZhbCh2YWx1ZSkKCiAgICBsb2NhbCBkcmFnZ2luZyA9IGZhbHNlCgogICAgQmFyLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpKQogICAgICAgIGlmIGkuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIHRoZW4KICAgICAgICAgICAgZHJhZ2dpbmcgPSB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgQmFyLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpKQogICAgICAgIGlmIGkuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIHRoZW4KICAgICAgICAgICAgZHJhZ2dpbmcgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIFVJUy5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpKQogICAgICAgIGlmIGRyYWdnaW5nIGFuZCBpLlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgdGhlbgogICAgICAgICAgICBsb2NhbCBwY3QgPSBtYXRoLmNsYW1wKAogICAgICAgICAgICAgICAgKGkuUG9zaXRpb24uWCAtIEJhci5BYnNvbHV0ZVBvc2l0aW9uLlgpIC8gQmFyLkFic29sdXRlU2l6ZS5YLAogICAgICAgICAgICAgICAgMCwgMQogICAgICAgICAgICApCiAgICAgICAgICAgIHNldFZhbChtaW4gKyAobWF4IC0gbWluKSAqIHBjdCkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgoJCS0tPT09PT09PT09PT0gQlVUVE9OID09PT09PT09PT09CgkJZnVuY3Rpb24gVGFiOkFkZEJ1dHRvbihvcHQpCgkJCWxvY2FsIEIgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iLCBQYWdlKQoJCQlCLlNpemUgPSBVRGltMi5uZXcoMSwtMTAsMCw0MCkKCQkJQi5UZXh0ID0gb3B0Lk5hbWUKCQkJQi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKCQkJQi5UZXh0U2l6ZSA9IDE0CgkJCUIuVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMSwxLDEpCgkJCUIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwyMjEsMCkKCQkJQi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQoJCQlJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgQikuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCw4KQoJCQlCLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3Qob3B0LkNhbGxiYWNrKQoJCWVuZAotLT09PT09PT09PT0gRFJPUERPV04gPT09PT09PT09PQogICAgICAgZnVuY3Rpb24gVGFiOkFkZERyb3Bkb3duKG9wdCkKICAgIGxvY2FsIEggPSBJbnN0YW5jZS5uZXcoIkZyYW1lIiwgUGFnZSkKICAgIEguU2l6ZSA9IFVEaW0yLm5ldygxLC0xMCwwLDQwKQogICAgSC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzUsMzUsMzUpCiAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgSCkuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCw4KQoKICAgIGxvY2FsIEJ0biA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIsIEgpCiAgICBCdG4uU2l6ZSA9IFVEaW0yLm5ldygxLC0yMCwxLDApCiAgICBCdG4uUG9zaXRpb24gPSBVRGltMi5uZXcoMCwxMCwwLDApCiAgICBCdG4uVGV4dCA9IG9wdC5OYW1lLi4iOiAiLi5vcHQuRGVmYXVsdAogICAgQnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtCiAgICBCdG4uVGV4dFNpemUgPSAxNAogICAgQnRuLlRleHRDb2xvcjMgPSBDb2xvcjMubmV3KDEsMSwxKQogICAgQnRuLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCgogICAgbG9jYWwgb3BlbiA9IGZhbHNlCiAgICBsb2NhbCBjdXJyZW50ID0gb3B0LkRlZmF1bHQKCiAgICBCdG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgb3BlbiA9IG5vdCBvcGVuCiAgICAgICAgaWYgb3BlbiB0aGVuCiAgICAgICAgICAgIGZvciBfLHYgaW4gcGFpcnMob3B0Lk9wdGlvbnMpIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBiID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgUGFnZSkKICAgICAgICAgICAgICAgIGI6U2V0QXR0cmlidXRlKCJEcm9wZG93bkl0ZW0iLCB0cnVlKQogICAgICAgICAgICAgICAgYi5TaXplID0gVURpbTIubmV3KDEsLTEwLDAsMzUpCiAgICAgICAgICAgICAgICBiLlRleHQgPSB2CiAgICAgICAgICAgICAgICBiLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig0NSw0NSw0NSkKICAgICAgICAgICAgICAgIGIuVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMSwxLDEpCiAgICAgICAgICAgICAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgYikuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCw2KQoKICAgICAgICAgICAgICAgIGIuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHYKICAgICAgICAgICAgICAgICAgICBCdG4uVGV4dCA9IG9wdC5OYW1lLi4iOiAiLi52CiAgICAgICAgICAgICAgICAgICAgaWYgb3B0LkNhbGxiYWNrIHRoZW4gb3B0LkNhbGxiYWNrKHYpIGVuZAogICAgICAgICAgICAgICAgICAgIGZvciBfLHggaW4gcGFpcnMoUGFnZTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB4OkdldEF0dHJpYnV0ZSgiRHJvcGRvd25JdGVtIikgdGhlbiB4OkRlc3Ryb3koKSAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIG9wZW4gPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKZW5kCgoJCXJldHVybiBUYWIKCWVuZAoKCXJldHVybiBXaW5kb3cKZW5kCgotLT09PT09PT09PT09PT09PT0gU0FGRSBSRVRSWSA9PT09PT09PT09PT09PT09PS0tCmxvY2FsIFdpbmRvdwpsb2NhbCBsb2FkZWQgPSBmYWxzZQoKZm9yIGkgPSAxLDUgZG8KICAgIGxvY2FsIG9rID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIFdpbmRvdyA9IExvYWRNYWluVUkoKQogICAgZW5kKQogICAgaWYgb2sgYW5kIFdpbmRvdyB0aGVuCiAgICAgICAgbG9hZGVkID0gdHJ1ZQogICAgICAgIGJyZWFrCiAgICBlbmQKICAgIHRhc2sud2FpdCgwLjMpCmVuZAoKaWYgbm90IGxvYWRlZCB0aGVuCiAgICBfRy5VSV9SRUFMX0JST0tFTiA9IHRydWUKICAgIGlmIExvYWRGYWxsYmFja1VJIHRoZW4KICAgICAgICBMb2FkRmFsbGJhY2tVSSgpCiAgICBlbmQKZW5kCgpsb2NhbCBTaG9wVGFiID0gV2luZG93OkNyZWF0ZVRhYigiVGFiIFNob3AiKQpsb2NhbCBQbGF5ZXJUYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCJUYWIgUGxheWVyIikKbG9jYWwgU2V0dGluZ1RhYiA9IFdpbmRvdzpDcmVhdGVUYWIoIlNldHRpbmcgRmFybSIpCmxvY2FsIEZhcm1UYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCJGYXJtZXIiKQpsb2NhbCBBd2FrZW5UYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCJBd2FrZW4gRnJ1aXQiKQpsb2NhbCBWNFRhYiAgPSBXaW5kb3c6Q3JlYXRlVGFiKCJ1cGdyYWRlIFY0IikKbG9jYWwgc2V0VGFiID0gV2luZG93OkNyZWF0ZVRhYigiU2V0dGluZyBIdWIiKSAKCnNldFRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJSZXNldCBTYXZlZCBLZXkiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgUmVzZXRLZXkoKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcjpLaWNrKCJLZXkgcmVzZXQhIFJlam9pbiBnYW1lLiIpCiAgICBlbmQKfSkKClNldHRpbmdUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQXV0byBvbiBWMyIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uQXV0b1YzID0gdgogICAgZW5kCn0pCgpTZXR0aW5nVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkF1dG8gb24gVjQiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgIENoZWVtLkF1dG9WNCA9IHYKICAgIGVuZAp9KQoKU2V0dGluZ1RhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIENsaWNrIiwKICAgIERlZmF1bHQgPSBDaGVlbS5BdXRvQ2xpY2ssCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uQXV0b0NsaWNrID0gdgogICAgZW5kCn0pCgpTZXR0aW5nVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkZhc3QgQXR0YWNrIiwKICAgIERlZmF1bHQgPSBDaGVlbS5GYXN0QXR0YWNrLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgIENoZWVtLkZhc3RBdHRhY2sgPSB2CiAgICBlbmQKfSkKClBsYXllclRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJGbHkiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgIENoZWVtLkZseSA9IHYKICAgIGVuZAp9KQoKUGxheWVyVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIk5vY2xpcCIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uTm9jbGlwID0gdgogICAgZW5kCn0pCgpQbGF5ZXJUYWI6QWRkU2xpZGVyKHsKICAgIE5hbWUgPSAiV2FsayBTcGVlZCIsCiAgICBNaW4gPSAxNiwKICAgIE1heCA9IDIwMCwKICAgIERlZmF1bHQgPSAxNiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odikKICAgICAgICBDaGVlbS5XYWxrU3BlZWQgPSB2CiAgICAgICAgbG9jYWwgaHVtID0gUGxheWVyLkNoYXJhY3RlciBhbmQgUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICBpZiBodW0gdGhlbgogICAgICAgICAgICBodW0uV2Fsa1NwZWVkID0gdgogICAgICAgIGVuZAogICAgZW5kCn0pCgpQbGF5ZXJUYWI6QWRkU2xpZGVyKHsKICAgIE5hbWUgPSAiSnVtcCBQb3dlciIsCiAgICBNaW4gPSA1MCwKICAgIE1heCA9IDMwMCwKICAgIERlZmF1bHQgPSA1MCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odikKICAgICAgICBDaGVlbS5KdW1wUG93ZXIgPSB2CiAgICAgICAgbG9jYWwgaHVtID0gUGxheWVyLkNoYXJhY3RlciBhbmQgUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICBpZiBodW0gdGhlbgogICAgICAgICAgICBodW0uSnVtcFBvd2VyID0gdgogICAgICAgIGVuZAogICAgZW5kCn0pCgpQbGF5ZXJUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiSW5maW5pdGUgSnVtcCIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uSW5mSnVtcCA9IHYKICAgIGVuZAp9KQoKQXdha2VuVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkF1dG8gQnV5IFJhaWQgQ2hpcCIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uQnV5Q2hpcCA9IHYKICAgIGVuZAp9KQoKQXdha2VuVGFiOkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSAiU2VsZWN0IENoaXAiLAogICAgT3B0aW9ucyA9IHsiRmxhbWUiLCJJY2UiLCJMaWdodCIsIk1hZ21hIiwiRGFyayIsIlJ1bWJsZSIsIkJ1ZGRoYSIsIkRvdWdoIn0sCiAgICBEZWZhdWx0ID0gIkZsYW1lIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odikKICAgICAgICBDaGVlbS5DaGlwRnJ1aXQgPSB2CiAgICBlbmQKfSkKCkF3YWtlblRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIEF3YWtlbiAoUmFpZCkiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgIENoZWVtLkF1dG9Bd2FrZW4gPSB2CiAgICAgICAgQ2hlZW0uQXV0b1JhaWQgPSB2CiAgICBlbmQKfSkKCkF3YWtlblRhYjpBZGREcm9wZG93bih7CiAgICBOYW1lID0gIlNlbGVjdCBBd2FrZW4gU2tpbGwiLAogICAgT3B0aW9ucyA9IHsiWiIsIlgiLCJDIiwiViIsIkYifSwKICAgIERlZmF1bHQgPSAiWiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uQXdha2VuU2tpbGwgPSB2CiAgICBlbmQKfSkKCkF3YWtlblRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIFRlbGVwb3J0IFJhaWQiLAogICAgRGVmYXVsdCA9IHRydWUsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uUmFpZFRlbGVwb3J0ID0gdgogICAgZW5kCn0pCgpGYXJtVGFiOkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSAiRmFybSBNb2RlIiwKICAgIERlZmF1bHQgPSBDaGVlbS5GYXJtTW9kZSwKICAgIE9wdGlvbnMgPSB7IkxldmVsIiwgIkJvbmVzIn0sCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uRmFybU1vZGUgPSB2CgogICAgICAgIC0tIHThuq90IGjhur90IGtoaSDEkeG7lWkgbW9kZQogICAgICAgIENoZWVtLkF1dG9GYXJtID0gZmFsc2UKICAgICAgICBDaGVlbS5BdXRvRmFybUJvbmVzID0gZmFsc2UKICAgIGVuZAp9KQoKRmFybVRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIEZhcm0gTGV2ZWwiLAogICAgRGVmYXVsdCA9IENoZWVtLkF1dG9GYXJtPSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odikKICAgICAgICBpZiBDaGVlbS5GYXJtTW9kZSB+PSAiTGV2ZWwiIHRoZW4KICAgICAgICAgICAgTm90aWZ5KCJIw6N5IGNo4buNbiBGYXJtIE1vZGUgPSBMZXZlbCIsIDIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIENoZWVtLkF1dG9GYXJtID0gdgogICAgICAgIGlmIHYgdGhlbgogICAgICAgICAgICBDaGVlbS5BdXRvRmFybUJvbmVzID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAp9KQoKRmFybVRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIEZhcm0gQm9uZXMgKFNlYSAzKSIsCiAgICBEZWZhdWx0ID0gQ2hlZW0uQXV0b0Zhcm1Cb25lcywKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odikKICAgICAgICBpZiBHZXRTZWEoKSB+PSAzIHRoZW4KICAgICAgICAgICAgTm90aWZ5KCJDaOG7iSBkw7luZyBGYXJtIEJvbmVzIOG7nyBTZWEgMyIsIDMpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIENoZWVtLkF1dG9GYXJtQm9uZXMgPSB2CiAgICAgICAgaWYgdiB0aGVuCiAgICAgICAgICAgIENoZWVtLkF1dG9GYXJtID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAp9KQoKU2V0dGluZ1RhYjpBZGREcm9wZG93bih7CglOYW1lID0gIkZhcm0gV2VhcG9uIiwKCU9wdGlvbnMgPSB7Ik1lbGVlIiwgIlN3b3JkIiwgIkd1biJ9LAoJRGVmYXVsdCA9IENoZWVtLldlYXBvbiBvciAiTWVsZWUiLAoJQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQoJCUNoZWVtLldlYXBvbiA9IHYKCWVuZAp9KQoKQ2hlZW0uTW9iTWFnbmV0ID0gZmFsc2UKClNldHRpbmdUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiY29sbGVjdCBtb25zdGVycyIsCiAgICBEZWZhdWx0ID0gQ2hlZW0uTW9iTWFnbmV0LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgIENoZWVtLk1vYk1hZ25ldCA9IHYKICAgIGVuZAp9KQoKVjRUYWI6QWRkRHJvcGRvd24oewogICAgTmFtZSA9ICJUcmlhbCBXZWFwb24iLAogICAgT3B0aW9ucyA9IHsiTWVsZWUiLCJTd29yZCIsIkd1biJ9LAogICAgRGVmYXVsdCA9ICJNZWxlZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCiAgICAgICAgQ2hlZW0uVHJpYWxXZWFwb24gPSB2CiAgICBlbmQKfSkKClY0VGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkF1dG8gRmlnaHQgVHJpYWwiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2KQogICAgICAgIENoZWVtLkF1dG9UcmlhbCA9IHYKICAgIGVuZAp9KQoKVjRUYWI6QWRkVG9nZ2xlKHsKCU5hbWUgPSAiSG9wIE1pcmFnZSBJc2xhbmQiLAoJRGVmYXVsdCA9IENoZWVtLkF1dG9Ib3AsCglDYWxsYmFjayA9IGZ1bmN0aW9uKHYpCgkJQ2hlZW0uQXV0b0hvcCA9IHYKCWVuZAp9KQoKVjRUYWI6QWRkVG9nZ2xlKHsKCU5hbWUgPSAiRmluZCBCbHVlIEdlYXIiLAoJRGVmYXVsdCA9IENoZWVtLkF1dG9CbHVlR2VhciwKCUNhbGxiYWNrID0gZnVuY3Rpb24odikKCQlDaGVlbS5BdXRvQmx1ZUdlYXIgPSB2CgllbmQKfSkKClNob3BUYWI6QWRkQnV0dG9uKHsKCU5hbWUgPSAiQnV5IEJsYWNrIExlZyIsCglDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQlCdXlTdHlsZSgiQmxhY2tMZWciKQoJZW5kCn0pCgpTaG9wVGFiOkFkZEJ1dHRvbih7CglOYW1lID0gIkJ1eSBFbGVjdHJvIiwKCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCUJ1eVN0eWxlKCJFbGVjdHJvIikKCWVuZAp9KQoKU2hvcFRhYjpBZGRCdXR0b24oewoJTmFtZSA9ICJCdXkgRmlzaG1hbiBLYXJhdGUiLAoJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJQnV5U3R5bGUoIkZpc2htYW5LYXJhdGUiKQoJZW5kCn0pCgpTaG9wVGFiOkFkZEJ1dHRvbih7CglOYW1lID0gIkJ1eSBEcmFnb24gQ2xhdyIsCglDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQlCdXlTdHlsZSgiRHJhZ29uQ2xhdyIpCgllbmQKfSkKClNob3BUYWI6QWRkQnV0dG9uKHsKCU5hbWUgPSAiUmVkZWVtIEFMTCBDb2RlcyIsCglDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQlmb3IgXyxjb2RlIGluIGlwYWlycyhHYW1lQ29kZXMpIGRvCgkJCVJlZGVlbUNvZGUoY29kZSkKCQkJdGFzay53YWl0KDAuMykKCQllbmQKCWVuZAp9KQoKLS09PT09PT09PT09PT09PT09IE1JUkFHRSBDSEVDSyAoUkVBTCkgPT09PT09PT09PT09PT09PT0tLQpsb2NhbCBMaWdodGluZyA9IGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKQpsb2NhbCBXb3Jrc3BhY2UgPSBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpCgpsb2NhbCBmdW5jdGlvbiBJc01pcmFnZUlzbGFuZFByZXNlbnQoKQogICAgLS0gMe+4j+KDoyBDaGVjayDDoW5oIHPDoW5nIMSR4bq3YyB0csawbmcKICAgIGlmIExpZ2h0aW5nOkZpbmRGaXJzdENoaWxkKCJBdG1vc3BoZXJlIikgdGhlbgogICAgICAgIGxvY2FsIGF0bSA9IExpZ2h0aW5nLkF0bW9zcGhlcmUKICAgICAgICBpZiBhdG0uRGVuc2l0eSA+IDAuMzUgYW5kIGF0bS5IYXplID4gMSB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSAy77iP4oOjIENoZWNrIMSR4bqjbyBs4bubbiBnaeG7r2EgYmnhu4NuCiAgICBmb3IgXyx2IGluIHBhaXJzKFdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHY6SXNBKCJNb2RlbCIpIGFuZCB2OkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgICBsb2NhbCBzaXplID0gdjpHZXRFeHRlbnRzU2l6ZSgpCiAgICAgICAgICAgIGlmIHNpemUuWCA+IDgwMCBhbmQgc2l6ZS5aID4gODAwIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gM++4j+KDoyBDaGVjayBOUEMgxJHhurdjIHRyxrBuZwogICAgbG9jYWwgTlBDcyA9IFdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiTlBDcyIpCiAgICBpZiBOUENzIHRoZW4KICAgICAgICBmb3IgXyxucGMgaW4gcGFpcnMoTlBDczpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBucGMuTmFtZTpsb3dlcigpOmZpbmQoImFkdmFuY2VkIikgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLT09PT09PT09PT09PT09PT0gRklORCBCTFVFIEdFQVIgPT09PT09PT09PT09PT09PT0tLQpsb2NhbCBmdW5jdGlvbiBGaW5kQmx1ZUdlYXIoKQogICAgZm9yIF8sdiBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICBpZiB2OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgIC0tIMSR4bq3YyB0csawbmcgQmx1ZSBHZWFyCiAgICAgICAgICAgIGlmIHYuQ29sb3IuQiA+IDIwMAogICAgICAgICAgICBhbmQgdi5NYXRlcmlhbCA9PSBFbnVtLk1hdGVyaWFsLk5lb24KICAgICAgICAgICAgYW5kIHYuU2l6ZS5NYWduaXR1ZGUgPCAxNSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gdgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIG5pbAplbmQKCmxvY2FsIGZ1bmN0aW9uIEdvVG9CbHVlR2VhcigpCiAgICBsb2NhbCBnZWFyID0gRmluZEJsdWVHZWFyKCkKICAgIGlmIGdlYXIgdGhlbgogICAgICAgIE5vdGlmeSgi8J+UtSBCTFVFIEdFQVIgRk9VTkQgISEhIiwgNikKICAgICAgICBUUChnZWFyLkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgNSwgMCkpCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgcmV0dXJuIGZhbHNlCmVuZAoKLS09PT09PT09PT09PT09PT09IEFVVE8gQkxVRSBHRUFSIExPT1AgPT09PT09PT09PT09PT09PT0tLQp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRhc2sud2FpdCgzKSBkbwogICAgICAgIGlmIG5vdCBDaGVlbS5BdXRvQmx1ZUdlYXIgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICBpZiBub3QgSXNNaXJhZ2VJc2xhbmRQcmVzZW50KCkgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgaWYgR29Ub0JsdWVHZWFyKCkgdGhlbgogICAgICAgICAgICBDaGVlbS5BdXRvQmx1ZUdlYXIgPSBmYWxzZQogICAgICAgICAgICBDaGVlbS5BdXRvSG9wID0gZmFsc2UKICAgICAgICAgICAgU2F2ZUNvbmZpZygpCiAgICAgICAgICAgIE5vdGlmeSgi4pyFIERPTkUgQkxVRSBHRUFSIiwgNSkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS09PT09PT09PT09PT09PT09IEFVVE8gSE9QIE1JUkFHRSAoU01BUlQpID09PT09PT09PT09PT09PT09LS0KdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoMikgZG8KICAgICAgICBpZiBub3QgQ2hlZW0uQXV0b0hvcCB0aGVuIGNvbnRpbnVlIGVuZAogICAgICAgIGlmIENoZWVtLkhvcE1vZGUgfj0gIk1pcmFnZSIgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgIC0tIHJlamVjdCBzZXJ2ZXIgxJHDoyBibGFja2xpc3QKICAgICAgICAgICAgICBpZiBJc0pvYkJsYWNrbGlzdGVkKEpvYklkKSB0aGVuCiAgICAgICAgICAgICAgICAgICBOb3RpZnkoIuKblCBCbGFja2xpc3RlZCBTZXJ2ZXIg4oaSIEhvcCIsIDIpCiAgICAgICAgICAgICAgICAgSG9wU2VydmVyKCkKICAgICAgICAgICAgICB0YXNrLndhaXQoMSkgCiAgICAgICAgICAgY29udGludWUKICAgICAgICBlbmQKCiAgICAgICAgU2VydmVyRW50ZXJUaWNrID0gdGljaygpIC0tIOKchSB0aMOqbSBkw7JuZyBuw6B5CiAgICAgICAgbG9jYWwgdmFsaWQsIHJlYXNvbiA9IElzVmFsaWRNaXJhZ2VTZXJ2ZXIoKQoKICAgICAgICAtLSA9PT09PSBCxq/hu5pDIDE6IFJFSkVDVCBOSEFOSCA9PT09PQogICAgICAgIGlmIG5vdCB2YWxpZCB0aGVuCiAgICAgICAgICAgIGlmIHRpY2soKSAtIFNlcnZlckVudGVyVGljayA8PSBRVUlDS19SRUpFQ1RfVElNRSB0aGVuCiAgICAgICAgICAgICAgICBOb3RpZnkoIuKdjCBSZWplY3QgU2VydmVyOiAiLi5yZWFzb24uLiIg4oaSIEhvcCIsIDIpCiAgICAgICAgICAgICAgICBIb3BTZXJ2ZXIoKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZW5kCgogICAgICAgIC0tID09PT09IELGr+G7mkMgMjogU0VSVkVSIEjhu6JQIEzhu4YgPT09PT0KICAgICAgICAgbG9jYWwgTm90aWZpZWRWYWxpZCA9IGZhbHNlCiAgICAgICAgIGlmIG5vdCBOb3RpZmllZFZhbGlkIHRoZW4KICAgIE5vdGlmeSgi4pyFIFZhbGlkIE1pcmFnZSBTZXJ2ZXIgfCBNb29uICIuLm1hdGguZmxvb3IoR2V0TW9vblBlcmNlbnQoKSkuLiIlIiwgMykKICAgIE5vdGlmaWVkVmFsaWQgPSB0cnVlCmVuZAogICAgICAgIC0tID09PT09IELGr+G7mkMgMzogQ0jhu5wgTUlSQUdFIFNQQVdOID09PT09CiAgICAgICAgaWYgSXNNaXJhZ2VJc2xhbmRQcmVzZW50KCkgdGhlbgogICAgICAgICAgICBOb3RpZnkoIvCfj53vuI8gTUlSQUdFIElTTEFORCBGT1VORCAhISEiLCA2KQogICAgICAgICAgICBDaGVlbS5BdXRvSG9wID0gZmFsc2UKICAgICAgICAgICAgU2F2ZUNvbmZpZygpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICAtLSBxdcOhIHRo4budaSBnaWFuIOKGkiBi4buPCiAgICAgICAgaWYgdGljaygpIC0gU2VydmVyRW50ZXJUaWNrID4gTUlSQUdFX1dBSVRfTElNSVQgdGhlbgogICAgICAgICAgICAgQWRkSm9iQmxhY2tsaXN0KEpvYklkLCAiTUlSQUdFX1RJTUVPVVQiKQogICAgICAgICAgICAgICAgIE5vdGlmeSgi4oybIFRpbWVvdXQgTWlyYWdlIOKGkiBIb3AgTmV3IFNlcnZlciIsIDMpCiAgICAgICAgICAgICAgICAgSG9wU2VydmVyKCkKICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkgCiAgICAgICAgICAgICAgICAgY29udGludWUgLS3inIUKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgotLT09PT09PT09PT09PT09PT0gTU9CIE1BR05FVCA9PT09PT09PT09PT09PT09PS0tCmxvY2FsIGZ1bmN0aW9uIFB1bGxNb2JzKHJhZGl1cykKICAgIGxvY2FsIGNoYXIgPSBQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIG5vdCBocnAgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgZW5lbWllcyA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiRW5lbWllcyIpCiAgICBpZiBub3QgZW5lbWllcyB0aGVuIHJldHVybiBlbmQKCiAgICBmb3IgXyxtb2IgaW4gcGFpcnMoZW5lbWllczpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIG1vYjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgYW5kIG1vYjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgIGFuZCBtb2IuSHVtYW5vaWQuSGVhbHRoID4gMCB0aGVuCgogICAgICAgICAgICBsb2NhbCBtaHJwID0gbW9iLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgaWYgKG1ocnAuUG9zaXRpb24gLSBocnAuUG9zaXRpb24pLk1hZ25pdHVkZSA8PSByYWRpdXMgdGhlbgogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIG1ocnAuQ0ZyYW1lID0gaHJwLkNGcmFtZSAqIENGcmFtZS5uZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGgucmFuZG9tKC0zLDMpLAogICAgICAgICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICBtYXRoLnJhbmRvbSgtMywzKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLS09PT09PSBRVUVTVCBDSEVDSyA9PT09PQpsb2NhbCBmdW5jdGlvbiBJc0RvaW5nUXVlc3QoKQogICAgbG9jYWwgZ3VpID0gUGxheWVyLlBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgiTWFpbiIpCiAgICBpZiBub3QgZ3VpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKICAgIGxvY2FsIHF1ZXN0ID0gZ3VpOkZpbmRGaXJzdENoaWxkKCJRdWVzdCIpCiAgICByZXR1cm4gcXVlc3QgYW5kIHF1ZXN0LlZpc2libGUKZW5kCgotLT09PT09PT09PT09PT09PT09PT09PT0gQVVUTyBGQVJNIExPT1AgKEZJWEVEKSA9PT09PT09PT09PT09PT09PT09PT09LS0KdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoMC4yNSkgZG8KICAgICAgICBUcnlFbmFibGVWMygpCiAgICAgICAgVHJ5RW5hYmxlVjQoKQogICAgICAgIAogICAgICAgIGlmIG5vdCBDaGVlbS5BdXRvRmFybSBvciBhdHRhY2tpbmcgdGhlbgogICAgICAgICAgICB0YXNrLndhaXQoMC40KQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGVuZAoKICAgICAgICAtLSBNT0IgTUFHTkVUCiAgICAgICAgaWYgQ2hlZW0uTW9iTWFnbmV0IHRoZW4KICAgICAgICAgICAgUHVsbE1vYnMoNDApCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgY2hhciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgbG9jYWwgaHVtID0gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgaWYgbm90IGhycCBvciBub3QgaHVtIG9yIGh1bS5IZWFsdGggPD0gMCB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGxvY2FsIGRhdGEgPSBQbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkRhdGEiKQogICAgICAgICAgICBpZiBub3QgZGF0YSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGxvY2FsIGxldmVsID0gZGF0YTpGaW5kRmlyc3RDaGlsZCgiTGV2ZWwiKQogICAgICAgICAgICBpZiBub3QgbGV2ZWwgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBsb2NhbCBxID0gR2V0UXVlc3QobGV2ZWwuVmFsdWUpCiAgICAgICAgICAgIGlmIG5vdCBxIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICAgICAgLS09PT09PSBTVEFSVCBRVUVTVCAoRklYRUQpID09PT09CiAgICAgICAgICAgIGlmIG5vdCBJc0RvaW5nUXVlc3QoKSBvciBsYXN0UXVlc3Qgfj0gcS5RdWVzdE5hbWUgdGhlbgogICAgICAgICAgICAgICAgbGFzdFF1ZXN0ID0gcS5RdWVzdE5hbWUKICAgICAgICAgICAgICAgIFRQKHEuSXNsYW5kUG9zKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNCkKCiAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUmVtb3Rlcy5Db21tRl86SW52b2tlU2VydmVyKAogICAgICAgICAgICAgICAgICAgICAgICAiU3RhcnRRdWVzdCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHEuUXVlc3ROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBxLlF1ZXN0TGV2ZWwKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAtLT09PT09IEZJTkQgJiBBVFRBQ0sgTU9CUyA9PT09PQogICAgICAgICAgICBsb2NhbCBlbmVtaWVzID0gd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJFbmVtaWVzIikKICAgICAgICAgICAgaWYgbm90IGVuZW1pZXMgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBmb3IgXywgbW9iIGluIHBhaXJzKGVuZW1pZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgIGlmIG5vdCBDaGVlbS5BdXRvRmFybSB0aGVuIGJyZWFrIGVuZAoKICAgICAgICAgICAgICAgIGlmIG1vYi5OYW1lID09IHEuTW9iTmFtZQogICAgICAgICAgICAgICAgYW5kIG1vYjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgYW5kIG1vYjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICBhbmQgbW9iLkh1bWFub2lkLkhlYWx0aCA+IDAgdGhlbgoKICAgICAgICAgICAgICAgICAgICBhdHRhY2tpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgRXF1aXBGYXJtV2VhcG9uKCkKCiAgICAgICAgICAgICAgICAgICAgaHJwLkNGcmFtZSA9IG1vYi5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgMTAsIDApCgogICAgICAgICAgICAgICAgICAgIGlmIENoZWVtLkZhc3RBdHRhY2sgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSA9IDEsIDUgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFEb3duKFZlY3RvcjIubmV3KDAsMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFVcChWZWN0b3IyLm5ldygwLDApKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFEb3duKFZlY3RvcjIubmV3KDAsMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFVcChWZWN0b3IyLm5ldygwLDApKQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBhdHRhY2tpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIHdhcm4oIltBdXRvRmFybSBFcnJvcl06IiwgZXJyKQogICAgICAgICAgICBhdHRhY2tpbmcgPSBmYWxzZQogICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICBlbmQKICAgIGVuZAoKLS09PT09PT09PT09IEFVVE8gQ0xJQ0sgTE9PUCA9PT09PT09PT0KdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0YXNrLndhaXQoMC4wNSkgZG8KICAgICAgICBpZiBub3QgQ2hlZW0uQXV0b0NsaWNrIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgVmlydHVhbFVzZXI6QnV0dG9uMURvd24oVmVjdG9yMi5uZXcoMCwwKSkKICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgIFZpcnR1YWxVc2VyOkJ1dHRvbjFVcChWZWN0b3IyLm5ldygwLDApKQogICAgICAgIGVuZCkKICAgIGVuZAplbmQpCgotLT09PT09PT09PT09PT09PT09PT09IENIRUVNIEhVQiBBTlRJLUxFQUsgKFNBRkUgRklYKSA9PT09PT09PT09PT09PT09PT09PS0tCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgdGFzay53YWl0KDgpCgogICAgbG9jYWwgUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCgogICAgbG9jYWwgV0hJVEVMSVNUID0gewogICAgICAgIFtQbGF5ZXIuVXNlcklkXSA9IHRydWUKICAgIH0KCiAgICBpZiBXSElURUxJU1RbUGxheWVyLlVzZXJJZF0gdGhlbgogICAgICAgIHJldHVybgogICAgZW5kCgotLT09PT09PT09PT09PT09PT09PT09IEVORCBBTlRJLUxFQUsgPT09PT09PT09PT09PT09PT09PT0tLQoKCi0tID09PT09PT09PT09PT09PT09IEVORCBTQUZFIE1PREUgPT09PT09PT09PT09PT09PT0KCmVuZCkKaWYgbm90IG9rIHRoZW4gd2FybigiQ0hFRU0gSFVCIENSQVNIOiIsIGVycikgZW5kCgplbmQpCgppZiBub3QgU0FGRV9PSyB0aGVuCiAgICB3YXJuKCJbQ2hlZW1IdWIgU0FGRSBNT0RFXSIsIFNBRkVfRVJSKQogICAgLS0gZmFsbGJhY2sgbWluaW1hbCBndWkKICAgIGxvY2FsIHNnID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgc2cuTmFtZSA9ICJDaGVlbUh1Yl9GYWxsYmFjayIKICAgIHNnLlJlc2V0T25TcGF3biA9IGZhbHNlCiAgICBzZy5QYXJlbnQgPSBDb3JlR3VpCgogICAgbG9jYWwgYnRuID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgc2cpCiAgICBidG4uU2l6ZSA9IFVEaW0yLmZyb21TY2FsZSgwLjE1LDAuMDgpCiAgICBidG4uUG9zaXRpb24gPSBVRGltMi5mcm9tU2NhbGUoMC4wMiwwLjQpCiAgICBidG4uVGV4dCA9ICJDaGVlbUh1YiIKICAgIGJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzAsMzAsMzApCiAgICBidG4uVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMSwxLDEpCmVuZAotLSBTQUZFIFdSQVBQRVIgRU5ECgplbmQpCgppZiBub3Qgc3VjY2VzcyB0aGVuCiAgICBMb2FkRmFsbGJhY2tVSSgpCmVuZAo='
local function d(s)
  local t={}
  local b64chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
  s=s:gsub('[^'..b64chars..'=]','')
  return (s:gsub('.',function(x)
    if x=='=' then return '' end
    local r,f='',(b64chars:find(x)-1)
    for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
    return r
  end):gsub('%d%d%d?%d?%d?%d?%d?%d?',function(x)
    if #x~=8 then return '' end
    local c=0
    for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
    return string.char(c)
  end))
end

local f=loadstring(d(b))
if f then f() end
